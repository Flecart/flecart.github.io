<!DOCTYPE html>
<html lang="en" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>Birdsong and Song System | X. Angelo Huang&#39;s Blog</title>
<meta name="keywords" content="neuroscience">
<meta name="description" content="How are inputs made into motion? We analyze feedback systems in auditory systems in birds.
Motivation
Birds are very good at producing and reproducing songs by moving their vocal cords complexly (sensory motor learning). We want to learn how they learn and then extrapolate on human or other kinds of speech learning.
Birds and Humans do not have much of a common ancestry (last one was fishes).
71% of the birds, both female and male birds sing, for Zebra finch it is a mating behaviour, so only male sing.">
<meta name="author" content="Xuanqiang &#39;Angelo&#39; Huang">
<link rel="canonical" href="https://flecart.github.io/notes/birdsong-and-song-system/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.45e028aa8ce0961349adf411b013ee39406be2c0bc80d4ea3fc04555f7f4611a.css" integrity="sha256-ReAoqozglhNJrfQRsBPuOUBr4sC8gNTqP8BFVff0YRo=" rel="preload stylesheet" as="style">
<link rel="icon" href="https://flecart.github.io/favicon-192x192.png">
<link rel="icon" type="image/png" sizes="16x16" href="https://flecart.github.io/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://flecart.github.io/favicon-32x32.png">
<link rel="apple-touch-icon" href="https://flecart.github.io/apple-touch-icon.png">
<link rel="mask-icon" href="https://flecart.github.io/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" hreflang="en" href="https://flecart.github.io/notes/birdsong-and-song-system/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --code-block-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript>



<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"] ],
        processEscapes: true
      }
    });
  </script>
<script type="text/javascript" async
src="//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>






      <script async src="https://www.googletagmanager.com/gtag/js?id=G-WW6NN2QGKF"></script>
      <script>
        var doNotTrack = false;
        if ( false ) {
          var dnt = (navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack);
          var doNotTrack = (dnt == "1" || dnt == "yes");
        }
        if (!doNotTrack) {
          window.dataLayer = window.dataLayer || [];
          function gtag(){dataLayer.push(arguments);}
          gtag('js', new Date());
          gtag('config', 'G-WW6NN2QGKF');
        }
      </script><meta property="og:url" content="https://flecart.github.io/notes/birdsong-and-song-system/">
  <meta property="og:site_name" content="X. Angelo Huang&#39;s Blog">
  <meta property="og:title" content="Birdsong and Song System">
  <meta property="og:description" content="How are inputs made into motion? We analyze feedback systems in auditory systems in birds.
Motivation Birds are very good at producing and reproducing songs by moving their vocal cords complexly (sensory motor learning). We want to learn how they learn and then extrapolate on human or other kinds of speech learning. Birds and Humans do not have much of a common ancestry (last one was fishes). 71% of the birds, both female and male birds sing, for Zebra finch it is a mating behaviour, so only male sing.">
  <meta property="og:locale" content="en">
  <meta property="og:type" content="article">
    <meta property="article:section" content="notes">
    <meta property="article:tag" content="Neuroscience">
      <meta property="og:image" content="https://flecart.github.io/images/papermod-cover.png">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="https://flecart.github.io/images/papermod-cover.png">
<meta name="twitter:title" content="Birdsong and Song System">
<meta name="twitter:description" content="How are inputs made into motion? We analyze feedback systems in auditory systems in birds.
Motivation
Birds are very good at producing and reproducing songs by moving their vocal cords complexly (sensory motor learning). We want to learn how they learn and then extrapolate on human or other kinds of speech learning.
Birds and Humans do not have much of a common ancestry (last one was fishes).
71% of the birds, both female and male birds sing, for Zebra finch it is a mating behaviour, so only male sing.">


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Notes",
      "item": "https://flecart.github.io/notes/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "Birdsong and Song System",
      "item": "https://flecart.github.io/notes/birdsong-and-song-system/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "Birdsong and Song System",
  "name": "Birdsong and Song System",
  "description": "How are inputs made into motion? We analyze feedback systems in auditory systems in birds.\nMotivation Birds are very good at producing and reproducing songs by moving their vocal cords complexly (sensory motor learning). We want to learn how they learn and then extrapolate on human or other kinds of speech learning. Birds and Humans do not have much of a common ancestry (last one was fishes). 71% of the birds, both female and male birds sing, for Zebra finch it is a mating behaviour, so only male sing.\n",
  "keywords": [
    "neuroscience"
  ],
  "articleBody": "How are inputs made into motion? We analyze feedback systems in auditory systems in birds.\nMotivation Birds are very good at producing and reproducing songs by moving their vocal cords complexly (sensory motor learning). We want to learn how they learn and then extrapolate on human or other kinds of speech learning. Birds and Humans do not have much of a common ancestry (last one was fishes). 71% of the birds, both female and male birds sing, for Zebra finch it is a mating behaviour, so only male sing.\nParallelism between humans and Birds If a baby does not receive any parent speech in some critical period, then it is not able to learn anymore.\nSee here\nHumans and monkeys have common ancestors. Assuming live emerged only once on earth, all living beings have common ancestors. A phylogenetic tree or evolutionary tree is a branching diagram showing the evolutionary relationships among various biological species or other entities—their phylogeny —based upon similarities and differences in their physical or genetic characteristics. Only humans are believed to have cumulative culture. A prerequisite of cumulative culture seems to be the ability to imitate actions. Vocal learning is an example of action imitation. Both songbirds and mammals have the ability of vocal learning, but their common ancestor (reptiles) did not seem to have this ability. A homoplasy is a character shared by a set of species but not present in their common ancestor. A good example is the evolution of the eye which has originated independently in many different species. In evolutionary biology, convergent evolution is the process whereby organisms not closely related (not monophyletic), independently evolve similar traits as a result of having to adapt to similar environments or ecological niches.\nZebra Finches Zebra Finch’s Song Both Zebra Finch and humans cannot learn to sing or speak anymore if in the critical period you don’t have a tutor, or somebody that speaks to you. Birds sing naturally (other neuroscientists using mices, they need to train them to do something specific), and learns from the environment. Scientists have analyzed the development of Zebra Finch singing as they aged using its spectogram, and have seen after some months it has become quite similar to the Tutor’s song. Only male birds learn to sing for mating reasons.\nIntroductory note Motif (repeated in the same way over and over again) It has some syllables with gaps in between. Learning to Sing During a first sensory learning phase, they store a memory (template) of tutor song, and during a subsequent sensorimotor learning phase they practice their own songs to arrive at a good copy of the template.\nThe following is a summary of the main idea of singing for Zebra Finches.\nSensory acquisition: Young bird hears tutor song → encodes auditory features. Template formation: Neural circuits in auditory forebrain (e.g., NCM, HVC) store a representation. Motor practice: Bird produces its own song via motor pathway (HVC → RA → nXIIts → syrinx). Error detection: Auditory feedback compares self-generated song with the template. Adjustment: Synaptic plasticity updates motor commands to reduce mismatch. Singing Patterns Subsong:\nLike babbling in human babies. The bird makes lots of random sounds and different note sequences. Nothing is organized yet, it has a very high variability during this stage. Plastic Song (practice)\nThe bird hears itself and compares to the tutor song (that has been memorized with sensory acquisition). It starts adjusting notes and sequences, making them more consistent. Still not perfect: some variability remains. Crystallized song (adult)\nBy adulthood, the song becomes stable and stereotyped. Each note and sequence is reproducible every time. This final song is usually a good copy of the tutor song. Once crystallized, the song doesn’t change anymore. Zebra Finch’s necessary conditions If a bird doesn’t have a tutor in the first part of their life they don’t learn to sing properly (not stereotyped, and produce also different kinds of songs), they also need auditory feedback (if they cannot hear feedback, they cannot learn properly, e.g. if you make them deaf). This is sort of true also for humans, this is called critical period of vocal learning. Offsprings of isolated tutors are able to relearn after 3-4 generations the Zebra Finch stereotyped song. So there is some innate direction where they prefer to sing, but they cannot learn it if they don’t have good parenting.\nIsolated birds They learn to sing, but often they have some not stereotyped parts or odd syllables. Deafened: they produce odd syllables that are very different compared to the template Song Learning Theory Types of errors Syntax errors: meaning the structure of the sentence in their language is wrong, for example ABC instead of ACB. Pitch Errors: they sing using different pitch\nSerial Tutoring Paradigm How can you elaborate a measure of vocal performance error, with respect for its semantics? For example if a baby is trying to say water, but says baba, how can you define such a measure? This measure should also work for birds. See (Lipkind et al. 2017).\nThis is where Serial Tutoring comes into place. Birds learn to do it in steps (as they need to learn both transitions source to target and target to source): For example first learn AAA, then ABABAB. They learn each syllable independently before being able to switch.\nLearning singing patterns In nature, we can find animals that learn in steps and then compose these steps to express their final behavior. In the image, you see a species of bird (Zebra Finch) that sings in regular patterns.\nSuppose that initially, it knows how to sing in the pattern ABCABC, and you want to teach it ACBACB.\nWhat happens is that it first learns to sing AC, then CB, and once it can perform BA, it is able to learn to sing ACBACB.\nThe above is very similar in human infants. It is possible to do something very similar also in humans. Infants first start to say syllables, and then couple them together. Duplications decrease in time., and variations are integrated in the child time.\nSongbirds do not Bifurcate If they have a pitch error, they chose to commit to only one pitch, and forget about the other.e They solve this by learning to sing a song for one syllable pitch and a call for the other. When they fork, they choose the syllable that is closer to their change.\nWhen they need to correct both pitch errors and sequence errors, they first fix the pitch and then fix the sequence.\nCalls = simple, innate, general communication Songs = complex, learned, reproductive communication What can they learn Juveniles match each syllable to the most spectrally similar sound in the target, regardless of its temporal position, resulting in unnecessary sequence errors, that they later try to correct (Lipkind et al. 2017)\nThey can learn sequence errors. They can also learn to correct pitch errors. They do not refurcate syllables (cannot learn b+ or b- but only one, but can add it into the song, they add the other into the call).\nThis is a Quadratic assignment problem, which is NP-hard (how they learn first, pitch or sequence error?). If you teach a sequence error and pitch error, the bird will:\nfirst learn to change pitch match Then change the position of the syllable. Pitch assignment is greedy (they choose the version that is closer) Every syllable greedily goes to the closest solution. Greedy vocabulary learning problem = making error corrections one syllable at a time without planning for later syllables can lead to suboptimal final sequences.\nAdult Birdsong Learning Song can be operantly conditioned by delivering auditory white noise (WN) bursts contingent on pitch of a targeted syllable. They try to compensate the error also in adults (they can learn to change it) (little headphones on birds, there is a cute image with birds on headphones). They are actually able to change the song with that, they usually do avoidance feedback. You can make them learn using trial and error (using small annoying sounds if they are too low for example). (you can make them further and further away from the correct pitch) Also learn for visual feedback, but it is a different direction, they seem to like the light to be off, difference between deaf and hearing birds (these ones do not like the light to be off). Maintakeaway:\nThey take very little time to change the pitch. They take very little time to learn the same song again after the noise is removed. See next section, the same feedback can be given in a visual format. Visual feedback The question now is if birds can learn from visual feedback: Visual feedback by briefly switching off the light in the sound-isolation chamber of the singing bird whenever the pitch of a targeted syllable was below (or above) a threshold. This was enough of a change to make them change the pitch of the syllables.\nBrain structures in song learning In this section we study the neural level of song learning in Zebra finches.\nHVC (High Vocal Center). DLM, medial portion of the dorsolateral thalamic nucleus; LMAN, lateral magnocellular nucleus of the anterior nidopallium; nXIIts, tracheosyringeal portion of the twelfth nerve; RA, robust nucleus of the arcopallium; Uva, nucleus uvaeformis; VTA/SNc; ventral tegmental area/substantial nigra pars compacta.\nSong Pathways Two pathways\nAnterior forebrain pathways And motor pathways Using systems we studied in The Neuron (glass with thing). Some neurons spike at some specific points in time. The motor pathway is necessary for song production and the anterior forebrain pathway (AFP) is necessary for song learning. Both of these pathways are important.\nThe AFP is a cortical-basal ganglia loop that consists of LMAN, basal ganglia homologue Area X, and the pallido-recipient thalamic nucleus DLM.\nNote that RA, HVC, and LMAN are in the avian pallium, which is evolutionarily and developmentally related to mammalian cortex.\nBird’s Thalamus: DLM Where it sits: It’s the thalamic relay nucleus within the bird song system, part of the anterior forebrain pathway (AFP), which is the basal ganglia–thalamocortical loop specialized for song learning.\nInputs:\nGets inhibitory input from Area X (bird basal ganglia, analogous to striatum + pallidum). Outputs:\nProjects excitatory output to LMAN (lateral magnocellular nucleus of the anterior nidopallium), which is like premotor cortex. What it does functionally:\nRelays basal ganglia–processed signals back to cortex (LMAN). Maintains and transmits variability in song output (important for trial-and-error exploration during learning). Provides the thalamic link that allows reinforcement signals (dopamine-driven) to influence motor exploration. In short, this is the zone that produces the signal to the cortex (LMAN) for learning.\nRole of HVC(RA) neurons HVC neurons can be antidromically identified by electrical stimulation in RA and area X. c, Example RA-projecting HVC neurons and putative interneurons that could be activated from RA but not from area X. Stimulation in RA, triggered by spontaneous spikes, results in spike collision for RA-projecting neurons but not for interneurons.\nThis allowed to discover the following:\nHVC(RA) neurons burst reliably at a single precise time in the song or call This is not the same as for the RA neurons they are projecting to. HVC interneurons spike or burst densely throughout these vocalizations. Song learning is then simply the process of modulating the effective connectivity from sparsely active HVC neurons to downstream motor neurons such that, at each moment, the correct motor output is produced: RA serves as a switchboard on which HVC(RA) neurons are wired up to the correct motor output.\nSong production of RA neurons Birds have more neurons per weight (about 2.2 times per unit weight). They recorded neural firing signals during song production, they see some kinds of clustering (in young birds it is quite random, while for adult birds they get more structured, and stereotyped). The following images are from a section called RA neurons. They have some properties:\nThey are sparse in activation, very precise in for the specific syllable that the bird is producing now. HVC and RA for learning HVC neurons spike only once (tells you when to play the note), while RA multiple times in a sequence (Tells you the note). If you remove HVC they cannot sing anymore, the subsong is the same, but plastic song is different and also the adult song is different.\nthe pattern of activity in RA, and thus the vocal output, is determined by the pattern of HVC(RA) -to-RA synapses; in this view, vocal learning is controlled by synaptic plasticity at these synapses. Song learning is then simply the process of modulating the effective connectivity from sparsely active HVC neurons to downstream motor neurons such that, at each moment, the correct motor output is produced: RA serves as a switchboard on which HVC(RA) neurons are wired up to the correct motor output.\nSong-aligned firing patterns in RA neurons change gradually during learning. As the song becomes less variable and more similar to the tutor, the firing patterns in RA become more reproducible, sparse, and bursty.\nHVC during Lesions Singing in the absence of HVC is highly similar to normal subsong. (A) Distributions of syllable durations for three birds of various ages (blue) and distributions for the same birds in the absence of HVC (red). (B) Average syllable duration distributions for normal subsong-producing birds (blue) and birds of different ages in the absence of HVC\nHVC is fundamental for producing song, if you don’t have it you produce songs very similar to the infants subsong.\nAntidromic stimulation Antidromic stimulation is a technique used for neuron identification in freely behaving animals. It allows to distinguish different types of projection neurons from each other and from interneurons via collision testing\nAntidromic stimulation means you stimulate an axon at a point downstream from the cell body, and the action potential travels backwards (towards the soma) along the axon.\nIf your electrode is in HVC, and you stimulate RA, you can test whether the neuron you’re recording from in HVC actually projects to RA.\nTo prove it’s truly the same neuron (not a polysynaptic response), you use a collision test. If you trigger an orthodromic spike just before the antidromic stimulus, the two action potentials collide in the axon and cancel. The inability to evoke an antidromic spike within the refractory period (~2 ms) confirms the recorded neuron is indeed an HVC→RA projection cell.\nCircuit Experiments Thermal Cooling of HVC HVC is for stereotypy and producing the songs. If you cool a brain area, you slow down the processes in that area. They observed that by cooling the HVC structure:\nThe song gets longer. (slown down) Then they sing faster if you remove the cooling and you just learn with the cooling part. This insight has been used in human speech articulation and timing (motor area for speak -\u003e not well comprensible, broca area -\u003e Speak slower). LMAN injects variability and bias LMAN generates variability of the learnt songs. We can view this as the explorer node in the brain. They lesioned LMAN to have this observation.\nPrevent context-dependent changes to song variability.\nIf you deaf it, the song becomes degraded.\nIf you lesion LMAN before deafness, the song is the same (no plasticity in learned songs).\nJuvenile birds with LMAN lesion cannot learn new songs anymore. LMAN biases output to avoid punishment: if you deactivate it, it unlearns the just learned thing.\nSomething similar has been seen with tetrotoxin injected to LMAN area. **(A)** Schematic: Shows that when LMAN is active (gray dot), the bird’s pitch deviates from baseline toward the learned direction (up or down). When LMAN is silenced (red dot), the pitch shifts back closer to baseline.**(B)** Time series: For one bird, across training days, you see that the pitch with LMAN active moves away from baseline (as learning progresses), but when you inactivate LMAN, the pitch immediately drops back toward the baseline.**(C)** Scatter plot: Across all inactivation tests, the same pattern: **LMAN+ pitch** is consistently shifted toward the learned direction.**LMAN− pitch** is closer to baseline.\nArea X lesions If you lesion Area X, even adult birds cannot learn anymore (aversive behaviour we have seen with light for example), as we see in Conditioning Theory, we need dopamine neurons to integrate feedback from the environment. But the song variability that LMAN injects is still present.\nLMAN’s variability is for plasticity the AFP has been shown to actively inject variability into the motor pathway; LMAN lesions slightly reduce trial-by-trial variability of diverse spectral features even in adult birds. They also showed it has variable firing rates to RA zone.\nDopamine in Zebra Finches Dopamine encodes the quality of sillables in some songbirds. This is as expected after studying Conditioning Theory, bad quality means low VTA activations.\nVTA has some dopinanergic input.\nVTAx neurons reward prediction error firing (higher if it is better than expected, and lower if lower than expected). Optogenetic experiment to test the above hypothesis (experimentally manipulate the firing of some neurons.). See Birdsong and Song System. Basically it injects a virus and activates or disactivates to increase or decrease the firing. Exciting the area is enough for active seek of change (increase of pitch is ok). In the other case they seem to go away, which is consistent with the theory we have with VTx neurons encode relative syllable quality compared to a tutor’s song. Delayed rewards are discounted.\nValence reversal caused by deafening Hearing birds already have sensory feedback, but deaf birds have a nice feedback, and have impact on the environment. They can manipulate the environment to get sensory feedback. This why they sorta just playing, this is why it is not punishing anymore, and it does not affect the playfulness value. See Intrinsic Motivation and Playfulness, for an explanation based on empowerment theory.\nVTA pathway VTA is a dopaminergic region that projects to Area X, if birds hear the sound the dopamine is lower (worse vs better than expected), if it doesn’t happen then it is a little higher suggesting internal rewards.\nMany dopaminergic neurons in the ventral tegmental area (VTA) project to Area X. Left: Strategy for antidromic identification of VTAx dopamine neurons. Top to bottom: spectrograms, spiking activity during undistorted and distorted trials, corresponding spike raster plots and rate histograms, and z-scored difference between undistorted and distorted rate histograms (plots aligned to target onset). Horizontal bars in histograms indicate significant deviations from baseline.\nThe motor system is attempting to predict its sensory feedbacks: Dopamine Neurons Encode Syllable Quality Left bottom: An example syllable (inside red box) on six different days as it is refined across development. Left top: Schematic showing computation of relative distance to adult syllable (circles, juvenile syllable renditions; black square, median location of adult (day \u003e 90) renditions; arrows, distance to adult syllable). Relative distance was calculated as the difference between the current distance to adult syllable and the mean distance of the previous 14 renditions (see Methods). Right: f, ΔF/F signals averaged across all 25 syllables and days 61−100 are plo ed similarly to e, but for each decile (10% of syllable renditions) of relative distance\nOptogenetics Manipulation of VTAX neurons We can inhibit and excite using optogenetics (viral expression of the dopamine) to guide the quality of learning (aversive vs preference-based learning). References [1] Lipkind et al. “Songbirds Work around Computational Complexity by Learning Song Vocabulary Independently of Sequence” Nature Communications Vol. 8(1), pp. 1247 2017 ",
  "wordCount" : "3222",
  "inLanguage": "en",
  "image": "https://flecart.github.io/images/papermod-cover.png","datePublished": "0001-01-01T00:00:00Z",
  "dateModified": "0001-01-01T00:00:00Z",
  "author":{
    "@type": "Person",
    "name": "Xuanqiang 'Angelo' Huang"
  },
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://flecart.github.io/notes/birdsong-and-song-system/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "X. Angelo Huang's Blog",
    "logo": {
      "@type": "ImageObject",
      "url": "https://flecart.github.io/favicon-192x192.png"
    }
  }
}
</script>
</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://flecart.github.io/" accesskey="h" title="X. Angelo Huang&#39;s Blog (Alt + H)">X. Angelo Huang&#39;s Blog</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="https://flecart.github.io/notes/" title="Notes">
                    <span>Notes</span>
                </a>
            </li>
            <li>
                <a href="https://flecart.github.io/archives" title="Archive">
                    <span>Archive</span>
                </a>
            </li>
            <li>
                <a href="https://flecart.github.io/search/" title="Search (Alt &#43; /)" accesskey=/>
                    <span>Search</span>
                </a>
            </li>
            <li>
                <a href="https://flecart.github.io/tags/" title="Tags">
                    <span>Tags</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    <div class="breadcrumbs"><a href="https://flecart.github.io/">Home</a>&nbsp;»&nbsp;<a href="https://flecart.github.io/notes/">Notes</a></div>
    <h1 class="post-title entry-hint-parent">
      Birdsong and Song System
    </h1>
    <div class="post-meta">16 min&nbsp;·&nbsp;Xuanqiang &#39;Angelo&#39; Huang

</div>
  </header> <div class="toc">
    <details >
        <summary accesskey="c" title="(Alt + C)">
            <span class="details">Table of Contents</span>
        </summary>

        <div class="inner"><ul><ul><ul>
                <li>
                    <a href="#motivation" aria-label="Motivation">Motivation</a><ul>
                        
                <li>
                    <a href="#parallelism-between-humans-and-birds" aria-label="Parallelism between humans and Birds">Parallelism between humans and Birds</a></li></ul>
                </li>
                <li>
                    <a href="#zebra--finches" aria-label="Zebra  Finches">Zebra  Finches</a><ul>
                        
                <li>
                    <a href="#zebra-finchs-song" aria-label="Zebra Finch&rsquo;s Song">Zebra Finch&rsquo;s Song</a></li>
                <li>
                    <a href="#learning-to-sing" aria-label="Learning to Sing">Learning to Sing</a></li>
                <li>
                    <a href="#singing-patterns" aria-label="Singing Patterns">Singing Patterns</a></li>
                <li>
                    <a href="#zebra-finchs-necessary-conditions" aria-label="Zebra Finch&rsquo;s necessary conditions">Zebra Finch&rsquo;s necessary conditions</a></li></ul>
                </li>
                <li>
                    <a href="#song-learning-theory" aria-label="Song Learning Theory">Song Learning Theory</a><ul>
                        
                <li>
                    <a href="#types-of-errors" aria-label="Types of errors">Types of errors</a></li>
                <li>
                    <a href="#serial-tutoring-paradigm" aria-label="Serial Tutoring Paradigm">Serial Tutoring Paradigm</a></li>
                <li>
                    <a href="#learning-singing-patterns" aria-label="Learning singing patterns">Learning singing patterns</a></li>
                <li>
                    <a href="#songbirds-do-not-bifurcate" aria-label="Songbirds do not Bifurcate">Songbirds do not Bifurcate</a></li>
                <li>
                    <a href="#what-can-they-learn" aria-label="What can they learn">What can they learn</a></li>
                <li>
                    <a href="#adult-birdsong-learning" aria-label="Adult Birdsong Learning">Adult Birdsong Learning</a></li>
                <li>
                    <a href="#visual-feedback" aria-label="Visual feedback">Visual feedback</a></li></ul>
                </li>
                <li>
                    <a href="#brain-structures-in-song-learning" aria-label="Brain structures in song learning">Brain structures in song learning</a><ul>
                        
                <li>
                    <a href="#song-pathways" aria-label="Song Pathways">Song Pathways</a></li>
                <li>
                    <a href="#birds-thalamus-dlm" aria-label="Bird&rsquo;s Thalamus: DLM">Bird&rsquo;s Thalamus: DLM</a></li>
                <li>
                    <a href="#role-of-hvcra-neurons" aria-label="Role of HVC(RA) neurons">Role of HVC(RA) neurons</a></li>
                <li>
                    <a href="#song-production-of-ra-neurons" aria-label="Song production of RA neurons">Song production of RA neurons</a></li>
                <li>
                    <a href="#hvc-and-ra-for-learning" aria-label="HVC and RA for learning">HVC and RA for learning</a></li>
                <li>
                    <a href="#hvc-during-lesions" aria-label="HVC during Lesions">HVC during Lesions</a></li>
                <li>
                    <a href="#antidromic-stimulation" aria-label="Antidromic stimulation">Antidromic stimulation</a></li></ul>
                </li>
                <li>
                    <a href="#circuit-experiments" aria-label="Circuit Experiments">Circuit Experiments</a><ul>
                        
                <li>
                    <a href="#thermal-cooling-of-hvc" aria-label="Thermal Cooling of HVC">Thermal Cooling of HVC</a></li>
                <li>
                    <a href="#lman-injects-variability-and-bias" aria-label="LMAN injects variability and bias">LMAN injects variability and bias</a></li>
                <li>
                    <a href="#area-x-lesions" aria-label="Area X lesions">Area X lesions</a></li>
                <li>
                    <a href="#lmans-variability-is-for-plasticity" aria-label="LMAN&rsquo;s variability is for plasticity">LMAN&rsquo;s variability is for plasticity</a></li>
                <li>
                    <a href="#dopamine-in-zebra-finches" aria-label="Dopamine in Zebra Finches">Dopamine in Zebra Finches</a></li>
                <li>
                    <a href="#valence-reversal-caused-by-deafening" aria-label="Valence reversal caused by deafening">Valence reversal caused by deafening</a></li>
                <li>
                    <a href="#vta-pathway" aria-label="VTA pathway">VTA pathway</a></li>
                <li>
                    <a href="#dopamine-neurons-encode-syllable-quality" aria-label="Dopamine Neurons Encode Syllable Quality">Dopamine Neurons Encode Syllable Quality</a></li>
                <li>
                    <a href="#optogenetics-manipulation-of-vtax-neurons" aria-label="Optogenetics Manipulation of VTAX neurons">Optogenetics Manipulation of VTAX neurons</a></li></ul>
                </li></ul>
                    </ul>
                    
                <li>
                    <a href="#references" aria-label="References">References</a>
                </li>
            </ul>
        </div>
    </details>
</div>

  <div class="post-content"><p>How are inputs made into motion? We analyze feedback systems in auditory systems in birds.</p>
<h3 id="motivation">Motivation<a hidden class="anchor" aria-hidden="true" href="#motivation">#</a></h3>
<p>Birds are very good at producing and reproducing songs by moving their vocal cords complexly (sensory motor learning). We want to learn how they learn and then extrapolate on human or other kinds of speech learning.
Birds and Humans do not have much of a common ancestry (last one was fishes).
71% of the birds, both female and male birds sing, for Zebra finch it is a mating behaviour, so only male sing.</p>
<h4 id="parallelism-between-humans-and-birds">Parallelism between humans and Birds<a hidden class="anchor" aria-hidden="true" href="#parallelism-between-humans-and-birds">#</a></h4>
<p>If a baby does not receive any parent speech in some critical period, then it is not able to learn anymore.</p>
<figure class="center">
<img src="/images/notes/Birdsong and Song System-20250814132145209.webp" style="width: 100%"   alt="Birdsong and Song System-20250814132145209" title="Birdsong and Song System-20250814132145209"/>
<figcaption><p style="text-align:center;"> See <a href="http://kbsewall.weebly.com/why-songbirds.html">here</a></p></figcaption>
</figure>
<blockquote>
<p>Humans and monkeys have common ancestors. Assuming live emerged only once on earth,
all living beings have common ancestors. A <strong>phylogenetic</strong> tree or evolutionary tree is a
branching diagram showing the evolutionary relationships among various biological species
or other entities—their <strong>phylogeny</strong> —based upon similarities and differences in their
physical or genetic characteristics. Only humans are believed to have cumulative culture. A
prerequisite of cumulative culture seems to be the ability to imitate actions.
Vocal learning is an example of action imitation. Both songbirds and mammals have the
ability of vocal learning, but their common ancestor (reptiles) did not seem to have this
ability. A <strong>homoplasy</strong> is a character shared by a set of species but not present in their
common ancestor. A good example is the evolution of the eye which has originated
independently in many different species.
In evolutionary biology, <strong>convergent evolution</strong> is the process whereby organisms not
closely related (not monophyletic), independently evolve similar traits as a result of having
to adapt to similar environments or ecological niches.</p></blockquote>
<h3 id="zebra--finches">Zebra  Finches<a hidden class="anchor" aria-hidden="true" href="#zebra--finches">#</a></h3>
<h4 id="zebra-finchs-song">Zebra Finch&rsquo;s Song<a hidden class="anchor" aria-hidden="true" href="#zebra-finchs-song">#</a></h4>
<p>Both Zebra Finch and humans cannot learn to sing or speak anymore if in the critical period you don&rsquo;t have a tutor, or somebody that speaks to you.
Birds sing naturally (other neuroscientists using mices, they need to train them to do something specific), and learns from the environment.
Scientists have analyzed the development of Zebra Finch singing as they aged using its spectogram, and have seen after some months it has become quite similar to the Tutor&rsquo;s song. Only male birds learn to sing for mating reasons.</p>
<ul>
<li>Introductory note</li>
<li>Motif (repeated in the same way over and over again)
<ul>
<li>It has some syllables with gaps in between.</li>
</ul>
</li>
</ul>
<h4 id="learning-to-sing">Learning to Sing<a hidden class="anchor" aria-hidden="true" href="#learning-to-sing">#</a></h4>
<p>During a first <strong>sensory learning</strong> phase, they store a memory (template) of tutor song, and during a subsequent <strong>sensorimotor</strong> learning phase they practice their own songs to arrive at a good copy of the template.</p>
<p>The following is a summary of the main idea of singing for Zebra Finches.</p>
<ol>
<li><strong>Sensory acquisition:</strong> Young bird hears tutor song → encodes auditory features.</li>
<li><strong>Template formation:</strong> Neural circuits in <strong>auditory forebrain (e.g., NCM, HVC)</strong> store a representation.</li>
<li><strong>Motor practice:</strong> Bird produces its own song via <strong>motor pathway (HVC → RA → nXIIts → syrinx)</strong>.</li>
<li><strong>Error detection:</strong> Auditory feedback compares self-generated song with the template.</li>
<li><strong>Adjustment:</strong> Synaptic plasticity updates motor commands to reduce mismatch.</li>
</ol>
<h4 id="singing-patterns">Singing Patterns<a hidden class="anchor" aria-hidden="true" href="#singing-patterns">#</a></h4>
<p><strong>Subsong</strong>:</p>
<ul>
<li>Like <strong>babbling in human babies</strong>.</li>
<li>The bird makes <strong>lots of random sounds</strong> and different note sequences.</li>
<li>Nothing is organized yet, it has a very high variability during this stage.</li>
</ul>
<p><strong>Plastic Song (practice)</strong></p>
<ul>
<li>The bird <strong>hears itself and compares to the tutor song</strong> (that has been memorized with sensory acquisition).</li>
<li>It starts <strong>adjusting notes and sequences</strong>, making them more consistent.</li>
<li>Still not perfect: some variability remains.</li>
</ul>
<p><strong>Crystallized song (adult)</strong></p>
<ul>
<li>By adulthood, the song becomes <strong>stable and stereotyped</strong>.</li>
<li>Each note and sequence is <strong>reproducible every time</strong>.</li>
<li>This final song is usually a <strong>good copy of the tutor song</strong>.</li>
<li>Once crystallized, <strong>the song doesn’t change anymore</strong>.</li>
</ul>
<h4 id="zebra-finchs-necessary-conditions">Zebra Finch&rsquo;s necessary conditions<a hidden class="anchor" aria-hidden="true" href="#zebra-finchs-necessary-conditions">#</a></h4>
<p>If a bird doesn&rsquo;t have a tutor in the first part of their life they don&rsquo;t learn to sing properly (not stereotyped, and produce also different kinds of songs), they also need <strong>auditory feedback</strong> (if they cannot hear feedback, they cannot learn properly, e.g. if you make them deaf).
This is sort of true also for humans, this is called <strong>critical period of vocal learning</strong>.
Offsprings of isolated tutors are able to relearn after 3-4 generations the Zebra Finch stereotyped song.
So there is some <strong>innate</strong> direction where they prefer to sing, but they cannot learn it if they don&rsquo;t have good parenting.</p>
<ul>
<li><strong>Isolated birds</strong> They learn to sing, but often they have some not stereotyped parts or odd syllables.</li>
<li><strong>Deafened</strong>: they produce odd syllables that are very different compared to the template</li>
</ul>
<h3 id="song-learning-theory">Song Learning Theory<a hidden class="anchor" aria-hidden="true" href="#song-learning-theory">#</a></h3>
<h4 id="types-of-errors">Types of errors<a hidden class="anchor" aria-hidden="true" href="#types-of-errors">#</a></h4>
<p><strong>Syntax errors:</strong> meaning the structure of the sentence in their language is wrong, for example ABC instead of ACB.
<strong>Pitch Errors</strong>: they sing using different pitch</p>
<h4 id="serial-tutoring-paradigm">Serial Tutoring Paradigm<a hidden class="anchor" aria-hidden="true" href="#serial-tutoring-paradigm">#</a></h4>
<p>How can you elaborate a measure of vocal performance error, with respect for its semantics? For example if a baby is trying to say water, but says baba, how can you define such a measure? This measure should also work for birds. See <a href="https://www.nature.com/articles/s41467-017-01436-0">(Lipkind et al. 2017)</a>.</p>
<p>This is where Serial Tutoring comes into place.
Birds learn to do it in steps (as they need to learn both transitions source to target and target to source):
For example first learn AAA, then ABABAB.
They learn each syllable independently before being able to switch.</p>
<h4 id="learning-singing-patterns">Learning singing patterns<a hidden class="anchor" aria-hidden="true" href="#learning-singing-patterns">#</a></h4>
<img src="/images/notes/Birdsong and Song System-20250327150309146.webp" style="width: 100%" class="center" alt="Birdsong and Song System-20250327150309146">
In nature, we can find animals that learn in steps and then compose these steps to express their final behavior.
<p>In the image, you see a species of bird (Zebra Finch) that sings in regular patterns.<br>
Suppose that initially, it knows how to sing in the pattern ABCABC, and you want to teach it ACBACB.<br>
What happens is that it first learns to sing AC, then CB, and once it can perform BA, it is able to learn to sing ACBACB.</p>
<p>The above is very similar in human infants.
It is possible to do something very similar also in humans. Infants first start to say syllables, and then couple them together. Duplications <strong>decrease in time.</strong>, and variations are integrated in the child time.</p>
<h4 id="songbirds-do-not-bifurcate">Songbirds do not Bifurcate<a hidden class="anchor" aria-hidden="true" href="#songbirds-do-not-bifurcate">#</a></h4>
<p>If they have a pitch error, they chose to commit to only one pitch, and forget about the other.e
<img src="/images/notes/Birdsong and Song System-20250823195222821.webp" style="width: 100%" class="center" alt="Birdsong and Song System-20250823195222821"></p>
<p>They solve this by learning to sing a song for one syllable pitch and a call for the other. When they fork, they choose the syllable that is closer to their change.</p>
<p>When they need to correct both pitch errors and sequence errors, they first fix the pitch and then fix the sequence.</p>
<ul>
<li><strong>Calls</strong> = simple, innate, general communication</li>
<li><strong>Songs</strong> = complex, learned, reproductive communication</li>
</ul>
<h4 id="what-can-they-learn">What can they learn<a hidden class="anchor" aria-hidden="true" href="#what-can-they-learn">#</a></h4>
<blockquote>
<p>Juveniles match each syllable to the most spectrally similar sound in the target, regardless of its temporal position, resulting in unnecessary sequence errors, that they later try to correct <a href="https://www.nature.com/articles/s41467-017-01436-0">(Lipkind et al. 2017)</a></p></blockquote>
<p>They can learn <strong>sequence errors</strong>.
They can also learn to correct <strong>pitch errors</strong>.
They do not <em>refurcate syllables</em> (cannot learn b+ or b- but only one, but can add it into the song, they add the other into the call).</p>
<p>This is a Quadratic assignment problem, which is NP-hard (how they learn first, pitch or sequence error?).
If you teach a sequence error and pitch error, the bird will:</p>
<ul>
<li>first learn to change pitch match</li>
<li>Then change the position of the syllable.</li>
<li>Pitch assignment is greedy (they choose the version that is closer)
<ul>
<li>Every syllable greedily goes to the closest solution.</li>
</ul>
</li>
</ul>
<p><strong>Greedy vocabulary learning problem =</strong> making error corrections <strong>one syllable at a time</strong> without planning for later syllables can lead to <strong>suboptimal final sequences</strong>.</p>
<h4 id="adult-birdsong-learning">Adult Birdsong Learning<a hidden class="anchor" aria-hidden="true" href="#adult-birdsong-learning">#</a></h4>
<p> Song can be <strong>operantly conditioned</strong> by delivering auditory white noise (WN) bursts contingent on pitch of a targeted syllable.
 <img src="/images/notes/Birdsong and Song System-20250815123113176.webp" width="600" class="center" alt="Birdsong and Song System-20250815123113176"/></p>
<ul>
<li>They try to compensate the <strong>error</strong> also in adults (they can learn to change it) (little headphones on birds, there is a cute image with birds on headphones).
<ul>
<li>They are actually able to change the song with that, they usually do avoidance feedback.</li>
</ul>
</li>
<li>You can make them learn using trial and error (using small annoying sounds if they are too low for example). (you can make them further and further away from the correct pitch)
<ul>
<li>Also learn for visual feedback, but it is a different direction, they seem to like the light to be off, difference between deaf and hearing birds (these ones do not like the light to be off).</li>
</ul>
</li>
</ul>
<p>Maintakeaway:</p>
<ul>
<li>They take very little time to change the pitch.</li>
<li>They take very little time to learn the same song again after the noise is removed.</li>
<li>See next section, the same feedback can be given in a visual format.</li>
</ul>
<h4 id="visual-feedback">Visual feedback<a hidden class="anchor" aria-hidden="true" href="#visual-feedback">#</a></h4>
<p>The question now is if birds can learn from visual feedback:
Visual feedback by briefly switching off the light in the sound-isolation chamber of the singing bird whenever the pitch of a targeted syllable was below (or above) a threshold.
This was enough of a change to make them change the pitch of the syllables.</p>
<h3 id="brain-structures-in-song-learning">Brain structures in song learning<a hidden class="anchor" aria-hidden="true" href="#brain-structures-in-song-learning">#</a></h3>
<p>In this section we study the neural level of song learning in Zebra finches.</p>
<p>HVC (High Vocal Center). DLM, medial portion of the dorsolateral thalamic nucleus; LMAN, lateral magnocellular nucleus of the anterior nidopallium; nXIIts, tracheosyringeal portion of the twelfth nerve; RA, robust nucleus of the arcopallium; Uva, nucleus uvaeformis; VTA/SNc; ventral tegmental area/substantial nigra pars compacta.</p>
<h4 id="song-pathways">Song Pathways<a hidden class="anchor" aria-hidden="true" href="#song-pathways">#</a></h4>
<p>Two pathways</p>
<ul>
<li><strong>Anterior forebrain pathways</strong></li>
<li>And <strong>motor pathways</strong></li>
</ul>
<p>Using systems we studied in <a href="/notes/the-neuron">The Neuron</a> (glass with thing). Some neurons spike at some specific points in time.
<img src="/images/notes/Birdsong and Song System-20250328151813932.webp" style="width: 100%" class="center" alt="Birdsong and Song System-20250328151813932"></p>
<p>The motor pathway is necessary for song production and the anterior forebrain pathway (AFP) is necessary for song learning.
Both of these pathways are important.</p>
<p>The AFP is a cortical-basal ganglia loop that consists of LMAN, basal ganglia homologue Area X, and the pallido-recipient thalamic nucleus DLM.</p>
<p>Note that RA, HVC, and LMAN are in the <strong>avian pallium</strong>, which is evolutionarily and developmentally related to mammalian cortex.</p>
<h4 id="birds-thalamus-dlm">Bird&rsquo;s Thalamus: DLM<a hidden class="anchor" aria-hidden="true" href="#birds-thalamus-dlm">#</a></h4>
<ul>
<li>
<p><strong>Where it sits:</strong> It’s the thalamic relay nucleus within the bird song system, part of the <strong>anterior forebrain pathway (AFP)</strong>, which is the basal ganglia–thalamocortical loop specialized for song learning.</p>
</li>
<li>
<p><strong>Inputs:</strong></p>
<ul>
<li>Gets inhibitory input from <strong>Area X</strong> (bird basal ganglia, analogous to striatum + pallidum).</li>
</ul>
</li>
<li>
<p><strong>Outputs:</strong></p>
<ul>
<li>Projects excitatory output to <strong>LMAN</strong> (lateral magnocellular nucleus of the anterior nidopallium), which is like premotor cortex.</li>
</ul>
</li>
<li>
<p><strong>What it does functionally:</strong></p>
<ul>
<li>Relays basal ganglia–processed signals back to cortex (LMAN).</li>
<li>Maintains and transmits variability in song output (important for trial-and-error exploration during learning).</li>
<li>Provides the thalamic link that allows reinforcement signals (dopamine-driven) to influence motor exploration.</li>
</ul>
</li>
</ul>
<p>In short, this is the zone that produces the signal to the cortex (LMAN) for learning.</p>
<h4 id="role-of-hvcra-neurons">Role of HVC(RA) neurons<a hidden class="anchor" aria-hidden="true" href="#role-of-hvcra-neurons">#</a></h4>
<p>HVC neurons can be antidromically identified by electrical stimulation in RA and area X. c, Example RA-projecting HVC neurons and putative interneurons that could be activated from RA but not from area X. Stimulation in RA, triggered by spontaneous spikes, results in spike collision for RA-projecting neurons but not for interneurons.</p>
<p>This allowed to discover the following:</p>
<ul>
<li>HVC(RA) neurons burst reliably at a single precise time in the song or call
<ul>
<li>This is not the same as for the RA neurons they are projecting to.</li>
</ul>
</li>
<li>HVC interneurons spike or burst densely throughout these vocalizations.</li>
</ul>
<p> Song learning is then simply the process of modulating the effective connectivity from sparsely active HVC neurons to downstream motor neurons such that, at each moment, the correct motor output is produced: RA serves as a switchboard on which HVC(RA) neurons are wired up to the correct motor output.</p>
<h4 id="song-production-of-ra-neurons">Song production of RA neurons<a hidden class="anchor" aria-hidden="true" href="#song-production-of-ra-neurons">#</a></h4>
<p>Birds have more neurons per weight (about 2.2 times per unit weight).
They recorded neural firing signals during song production, they see some kinds of clustering (in young birds it is quite random, while for adult birds they get more structured, and stereotyped).
The following images are from a section called <strong>RA neurons</strong>.
They have some properties:</p>
<ul>
<li>They are sparse in activation, very precise in for the specific syllable that the bird is producing now.</li>
</ul>
<img src="/images/notes/Birdsong and Song System-20250327153454452.webp" style="width: 100%" class="center" alt="Birdsong and Song System-20250327153454452">
<h4 id="hvc-and-ra-for-learning">HVC and RA for learning<a hidden class="anchor" aria-hidden="true" href="#hvc-and-ra-for-learning">#</a></h4>
<p>HVC neurons spike only once (tells you when to play the note), while RA multiple times in a sequence (Tells you the note).
If you remove HVC they <strong>cannot sing anymore</strong>, the subsong is the same, but plastic song is different and also the adult song is different.</p>
<img src="/images/notes/Birdsong and Song System-20250823220746464.webp" style="width: 100%" class="center" alt="Birdsong and Song System-20250823220746464">
<p>the pattern of activity in RA, and thus the vocal output, is determined by the <strong>pattern</strong> of HVC(RA) -to-RA synapses; in this view, vocal learning is controlled by synaptic plasticity at these synapses. Song learning is then simply the process of modulating the effective connectivity from sparsely active HVC neurons to downstream motor neurons such that, at each moment, the correct motor output is produced: RA serves as a switchboard on which HVC(RA) neurons are wired up to the correct motor output.</p>
<blockquote>
<p>Song-aligned firing patterns in RA neurons change gradually during learning. As the song becomes less variable and more similar to the tutor, the firing patterns in RA become <em>more reproducible</em>, sparse, and <strong>bursty</strong>.</p></blockquote>
<h4 id="hvc-during-lesions">HVC during Lesions<a hidden class="anchor" aria-hidden="true" href="#hvc-during-lesions">#</a></h4>
<figure class="center">
<img src="/images/notes/Birdsong and Song System-20250815125703525.webp" style="width: 100%"   alt="Birdsong and Song System-20250815125703525" title="Birdsong and Song System-20250815125703525"/>
<figcaption><p style="text-align:center;"> Singing in the absence of HVC is highly similar to normal subsong. (A) Distributions of syllable durations for three birds of various ages (blue) and distributions for the same birds in the absence of HVC (red). (B) Average syllable duration distributions for normal subsong-producing birds (blue) and birds of different ages in the absence of HVC</p></figcaption>
</figure>
<p>HVC is fundamental for producing song, if you don&rsquo;t have it you produce songs very similar to the infants subsong.</p>
<h4 id="antidromic-stimulation">Antidromic stimulation<a hidden class="anchor" aria-hidden="true" href="#antidromic-stimulation">#</a></h4>
<blockquote>
<p> <strong>Antidromic stimulation</strong> is a technique used for neuron identification in freely behaving animals. It allows to distinguish different types of projection neurons from each other and from interneurons via collision testing</p></blockquote>
<p><strong>Antidromic stimulation</strong> means you stimulate an axon at a point <strong>downstream</strong> from the cell body, and the action potential travels <em>backwards</em> (towards the soma) along the axon.<br>
If your electrode is in HVC, and you stimulate RA, you can test whether the neuron you’re recording from in HVC actually projects to RA.</p>
<p>To prove it’s truly the same neuron (not a polysynaptic response), you use a <strong>collision test</strong>. If you trigger an orthodromic spike just before the antidromic stimulus, the two action potentials collide in the axon and cancel. The inability to evoke an antidromic spike within the refractory period (~2 ms) confirms the recorded neuron is indeed an HVC→RA projection cell.</p>
<h3 id="circuit-experiments">Circuit Experiments<a hidden class="anchor" aria-hidden="true" href="#circuit-experiments">#</a></h3>
<h4 id="thermal-cooling-of-hvc">Thermal Cooling of HVC<a hidden class="anchor" aria-hidden="true" href="#thermal-cooling-of-hvc">#</a></h4>
<p>HVC is for <strong>stereotypy</strong> and producing the songs.
If you cool a brain area, you slow down the processes in that area.
They observed that by cooling the HVC structure:</p>
<ul>
<li>The song gets longer. (<strong>slown down</strong>)</li>
<li>Then they sing faster if you remove the cooling and you just learn with the cooling part.
This insight has been used in human speech articulation and timing (motor area for speak -&gt; not well comprensible, broca area -&gt; Speak slower).</li>
</ul>
<h4 id="lman-injects-variability-and-bias">LMAN injects variability and bias<a hidden class="anchor" aria-hidden="true" href="#lman-injects-variability-and-bias">#</a></h4>
<p>LMAN generates <strong>variability</strong> of the learnt songs. We can view this as the explorer node in the brain.
They lesioned LMAN to have this observation.</p>
<ul>
<li>
<p>Prevent context-dependent changes to song variability.</p>
</li>
<li>
<p>If you deaf it, the song becomes degraded.</p>
</li>
<li>
<p>If you lesion LMAN before deafness, the song is the same (no plasticity in learned songs).</p>
<ul>
<li>Juvenile birds with LMAN lesion cannot learn new songs anymore.</li>
</ul>
</li>
<li>
<p>LMAN <strong>biases output to avoid punishment</strong>: if you deactivate it, it unlearns the just learned thing.</p>
<ul>
<li>Something similar has been seen with tetrotoxin injected to LMAN area.</li>
</ul>
</li>
</ul>
<figure class="center">
<img src="/images/notes/Birdsong and Song System-20250823222824029.webp" style="width: 100%"   alt="Birdsong and Song System-20250823222824029" title="Birdsong and Song System-20250823222824029"/>
<figcaption><p style="text-align:center;"> **(A)** Schematic:  Shows that when LMAN is active (gray dot), the bird’s pitch deviates from baseline toward the learned direction (up or down).  When LMAN is silenced (red dot), the pitch shifts back closer to baseline.**(B)** Time series:  For one bird, across training days, you see that the pitch with LMAN active moves away from baseline (as learning progresses), but when you inactivate LMAN, the pitch immediately drops back toward the baseline.**(C)** Scatter plot:  Across all inactivation tests, the same pattern: **LMAN+ pitch** is consistently shifted toward the learned direction.**LMAN− pitch** is closer to baseline.</p></figcaption>
</figure>
<h4 id="area-x-lesions">Area X lesions<a hidden class="anchor" aria-hidden="true" href="#area-x-lesions">#</a></h4>
<p>If you lesion <strong>Area X</strong>, even adult birds cannot learn anymore (aversive behaviour we have seen with light for example), as we see in <a href="/notes/conditioning-theory">Conditioning Theory</a>, we need dopamine neurons to integrate feedback from the environment.
But the song <strong>variability</strong> that LMAN injects is still present.</p>
<h4 id="lmans-variability-is-for-plasticity">LMAN&rsquo;s variability is for plasticity<a hidden class="anchor" aria-hidden="true" href="#lmans-variability-is-for-plasticity">#</a></h4>
<p> the AFP has been shown to actively inject variability into the motor pathway; LMAN lesions slightly reduce trial-by-trial variability of diverse spectral features even in adult birds.
 They also showed it has variable firing rates to RA zone.</p>
<img src="/images/notes/Birdsong and Song System-20250825090345374.webp" style="width: 100%" class="center" alt="Birdsong and Song System-20250825090345374">
<h4 id="dopamine-in-zebra-finches">Dopamine in Zebra Finches<a hidden class="anchor" aria-hidden="true" href="#dopamine-in-zebra-finches">#</a></h4>
<p>Dopamine encodes the <strong>quality of sillables</strong> in some songbirds. This is as expected after studying <a href="/notes/conditioning-theory">Conditioning Theory</a>, bad quality means low VTA activations.</p>
<p>VTA has some dopinanergic input.</p>
<ul>
<li>VTAx neurons reward prediction error firing (higher if it is better than expected, and lower if lower than expected).</li>
<li>Optogenetic experiment to test the above hypothesis (experimentally manipulate the firing of some neurons.). See <a href="/notes/birdsong-and-song-system">Birdsong and Song System</a>.
<ul>
<li>Basically it injects a virus and activates or disactivates to increase or decrease the firing.</li>
<li>Exciting the area is enough for active seek of change (increase of pitch is ok).</li>
<li>In the other case they seem to go away, which is consistent with the theory we have with</li>
</ul>
</li>
<li>VTx neurons encode relative syllable quality compared to a tutor&rsquo;s song.</li>
</ul>
<p>Delayed rewards are discounted.</p>
<h4 id="valence-reversal-caused-by-deafening">Valence reversal caused by deafening<a hidden class="anchor" aria-hidden="true" href="#valence-reversal-caused-by-deafening">#</a></h4>
<p>Hearing birds already have sensory feedback, but deaf birds have a nice feedback, and have impact on the environment. They can manipulate the environment to get sensory feedback. This why they sorta just playing, this is why it is not punishing anymore, and it does not affect the playfulness value.
See <a href="/notes/intrinsic-motivation-and-playfulness">Intrinsic Motivation and Playfulness</a>, for an explanation based on <em>empowerment</em> theory.</p>
<h4 id="vta-pathway">VTA pathway<a hidden class="anchor" aria-hidden="true" href="#vta-pathway">#</a></h4>
<p>VTA is a <em>dopaminergic region</em> that projects to Area X, if birds hear the sound the dopamine is lower (worse vs better than expected), if it doesn&rsquo;t happen then it is a little higher suggesting internal rewards.</p>
<figure class="center">
<img src="/images/notes/Birdsong and Song System-20250823222241621.webp" style="width: 100%"   alt="Birdsong and Song System-20250823222241621" title="Birdsong and Song System-20250823222241621"/>
<figcaption><p style="text-align:center;"> Many dopaminergic neurons in the ventral tegmental area (VTA) project to Area X. Left: Strategy for antidromic identification of VTAx dopamine neurons. Top to bottom: spectrograms, spiking activity during undistorted and distorted trials, corresponding spike raster plots and rate histograms, and z-scored difference between undistorted and distorted rate histograms (plots aligned to target onset). Horizontal bars in histograms indicate significant deviations from baseline.</p></figcaption>
</figure>
<p>The motor system is attempting to predict its sensory feedbacks:
<img src="/images/notes/Birdsong and Song System-20250328153359503.webp" style="width: 100%" class="center" alt="Birdsong and Song System-20250328153359503"></p>
<h4 id="dopamine-neurons-encode-syllable-quality">Dopamine Neurons Encode Syllable Quality<a hidden class="anchor" aria-hidden="true" href="#dopamine-neurons-encode-syllable-quality">#</a></h4>
<figure class="center">
<img src="/images/notes/Birdsong and Song System-20250825130908273.webp" style="width: 100%"   alt="Birdsong and Song System-20250825130908273" title="Birdsong and Song System-20250825130908273"/>
<figcaption><p style="text-align:center;">Left bottom: An example syllable (inside red box) on six different days as it is refined across development. Left top: Schematic showing computation of relative distance to adult syllable (circles, juvenile syllable renditions; black square, median location of adult (day > 90) renditions; arrows, distance to adult syllable). Relative distance was calculated as the difference between the current distance to adult syllable and the mean distance of the previous 14 renditions (see Methods). Right: f, ΔF/F signals averaged across all 25 syllables and days 61−100 are plo ed similarly to e, but for each decile (10% of syllable renditions) of relative distance</p></figcaption>
</figure>
<h4 id="optogenetics-manipulation-of-vtax-neurons">Optogenetics Manipulation of VTAX neurons<a hidden class="anchor" aria-hidden="true" href="#optogenetics-manipulation-of-vtax-neurons">#</a></h4>
<p>We can inhibit and excite using optogenetics (viral expression of the dopamine) to guide the quality of learning (aversive vs preference-based learning).
<img src="/images/notes/Birdsong and Song System-20250825131108698.webp" style="width: 100%" class="center" alt="Birdsong and Song System-20250825131108698"></p>
<h1 id="references">References<a hidden class="anchor" aria-hidden="true" href="#references">#</a></h1>
<p id=lipkindSongbirdsWorkComputational2017>[1] Lipkind et al. <a href="https://www.nature.com/articles/s41467-017-01436-0">“Songbirds Work around Computational Complexity by Learning Song Vocabulary Independently of Sequence”</a> Nature Communications Vol. 8(1), pp. 1247 2017
 </p>

  </div>

  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="https://flecart.github.io/tags/neuroscience/">Neuroscience</a></li>
    </ul>


<ul class="share-buttons">
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share Birdsong and Song System on x"
            href="https://x.com/intent/tweet/?text=Birdsong%20and%20Song%20System&amp;url=https%3a%2f%2fflecart.github.io%2fnotes%2fbirdsong-and-song-system%2f&amp;hashtags=neuroscience">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M512 62.554 L 512 449.446 C 512 483.97 483.97 512 449.446 512 L 62.554 512 C 28.03 512 0 483.97 0 449.446 L 0 62.554 C 0 28.03 28.029 0 62.554 0 L 449.446 0 C 483.971 0 512 28.03 512 62.554 Z M 269.951 190.75 L 182.567 75.216 L 56 75.216 L 207.216 272.95 L 63.9 436.783 L 125.266 436.783 L 235.9 310.383 L 332.567 436.783 L 456 436.783 L 298.367 228.367 L 432.367 75.216 L 371.033 75.216 Z M 127.633 110 L 164.101 110 L 383.481 400.065 L 349.5 400.065 Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share Birdsong and Song System on linkedin"
            href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2fflecart.github.io%2fnotes%2fbirdsong-and-song-system%2f&amp;title=Birdsong%20and%20Song%20System&amp;summary=Birdsong%20and%20Song%20System&amp;source=https%3a%2f%2fflecart.github.io%2fnotes%2fbirdsong-and-song-system%2f">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-288.985,423.278l0,-225.717l-75.04,0l0,225.717l75.04,0Zm270.539,0l0,-129.439c0,-69.333 -37.018,-101.586 -86.381,-101.586c-39.804,0 -57.634,21.891 -67.617,37.266l0,-31.958l-75.021,0c0.995,21.181 0,225.717 0,225.717l75.02,0l0,-126.056c0,-6.748 0.486,-13.492 2.474,-18.315c5.414,-13.475 17.767,-27.434 38.494,-27.434c27.135,0 38.007,20.707 38.007,51.037l0,120.768l75.024,0Zm-307.552,-334.556c-25.674,0 -42.448,16.879 -42.448,39.002c0,21.658 16.264,39.002 41.455,39.002l0.484,0c26.165,0 42.452,-17.344 42.452,-39.002c-0.485,-22.092 -16.241,-38.954 -41.943,-39.002Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share Birdsong and Song System on reddit"
            href="https://reddit.com/submit?url=https%3a%2f%2fflecart.github.io%2fnotes%2fbirdsong-and-song-system%2f&title=Birdsong%20and%20Song%20System">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-3.446,265.638c0,-22.964 -18.616,-41.58 -41.58,-41.58c-11.211,0 -21.361,4.457 -28.841,11.666c-28.424,-20.508 -67.586,-33.757 -111.204,-35.278l18.941,-89.121l61.884,13.157c0.756,15.734 13.642,28.29 29.56,28.29c16.407,0 29.706,-13.299 29.706,-29.701c0,-16.403 -13.299,-29.702 -29.706,-29.702c-11.666,0 -21.657,6.792 -26.515,16.578l-69.105,-14.69c-1.922,-0.418 -3.939,-0.042 -5.585,1.036c-1.658,1.073 -2.811,2.761 -3.224,4.686l-21.152,99.438c-44.258,1.228 -84.046,14.494 -112.837,35.232c-7.468,-7.164 -17.589,-11.591 -28.757,-11.591c-22.965,0 -41.585,18.616 -41.585,41.58c0,16.896 10.095,31.41 24.568,37.918c-0.639,4.135 -0.99,8.328 -0.99,12.576c0,63.977 74.469,115.836 166.33,115.836c91.861,0 166.334,-51.859 166.334,-115.836c0,-4.218 -0.347,-8.387 -0.977,-12.493c14.564,-6.47 24.735,-21.034 24.735,-38.001Zm-119.474,108.193c-20.27,20.241 -59.115,21.816 -70.534,21.816c-11.428,0 -50.277,-1.575 -70.522,-21.82c-3.007,-3.008 -3.007,-7.882 0,-10.889c3.003,-2.999 7.882,-3.003 10.885,0c12.777,12.781 40.11,17.317 59.637,17.317c19.522,0 46.86,-4.536 59.657,-17.321c3.016,-2.999 7.886,-2.995 10.885,0.008c3.008,3.011 3.003,7.882 -0.008,10.889Zm-5.23,-48.781c-16.373,0 -29.701,-13.324 -29.701,-29.698c0,-16.381 13.328,-29.714 29.701,-29.714c16.378,0 29.706,13.333 29.706,29.714c0,16.374 -13.328,29.698 -29.706,29.698Zm-160.386,-29.702c0,-16.381 13.328,-29.71 29.714,-29.71c16.369,0 29.689,13.329 29.689,29.71c0,16.373 -13.32,29.693 -29.689,29.693c-16.386,0 -29.714,-13.32 -29.714,-29.693Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share Birdsong and Song System on facebook"
            href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fflecart.github.io%2fnotes%2fbirdsong-and-song-system%2f">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-106.468,0l0,-192.915l66.6,0l12.672,-82.621l-79.272,0l0,-53.617c0,-22.603 11.073,-44.636 46.58,-44.636l36.042,0l0,-70.34c0,0 -32.71,-5.582 -63.982,-5.582c-65.288,0 -107.96,39.569 -107.96,111.204l0,62.971l-72.573,0l0,82.621l72.573,0l0,192.915l-191.104,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share Birdsong and Song System on whatsapp"
            href="https://api.whatsapp.com/send?text=Birdsong%20and%20Song%20System%20-%20https%3a%2f%2fflecart.github.io%2fnotes%2fbirdsong-and-song-system%2f">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-58.673,127.703c-33.842,-33.881 -78.847,-52.548 -126.798,-52.568c-98.799,0 -179.21,80.405 -179.249,179.234c-0.013,31.593 8.241,62.428 23.927,89.612l-25.429,92.884l95.021,-24.925c26.181,14.28 55.659,21.807 85.658,21.816l0.074,0c98.789,0 179.206,-80.413 179.247,-179.243c0.018,-47.895 -18.61,-92.93 -52.451,-126.81Zm-126.797,275.782l-0.06,0c-26.734,-0.01 -52.954,-7.193 -75.828,-20.767l-5.441,-3.229l-56.386,14.792l15.05,-54.977l-3.542,-5.637c-14.913,-23.72 -22.791,-51.136 -22.779,-79.287c0.033,-82.142 66.867,-148.971 149.046,-148.971c39.793,0.014 77.199,15.531 105.329,43.692c28.128,28.16 43.609,65.592 43.594,105.4c-0.034,82.149 -66.866,148.983 -148.983,148.984Zm81.721,-111.581c-4.479,-2.242 -26.499,-13.075 -30.604,-14.571c-4.105,-1.495 -7.091,-2.241 -10.077,2.241c-2.986,4.483 -11.569,14.572 -14.182,17.562c-2.612,2.988 -5.225,3.364 -9.703,1.12c-4.479,-2.241 -18.91,-6.97 -36.017,-22.23c-13.314,-11.876 -22.304,-26.542 -24.916,-31.026c-2.612,-4.484 -0.279,-6.908 1.963,-9.14c2.016,-2.007 4.48,-5.232 6.719,-7.847c2.24,-2.615 2.986,-4.484 4.479,-7.472c1.493,-2.99 0.747,-5.604 -0.374,-7.846c-1.119,-2.241 -10.077,-24.288 -13.809,-33.256c-3.635,-8.733 -7.327,-7.55 -10.077,-7.688c-2.609,-0.13 -5.598,-0.158 -8.583,-0.158c-2.986,0 -7.839,1.121 -11.944,5.604c-4.105,4.484 -15.675,15.32 -15.675,37.364c0,22.046 16.048,43.342 18.287,46.332c2.24,2.99 31.582,48.227 76.511,67.627c10.685,4.615 19.028,7.371 25.533,9.434c10.728,3.41 20.492,2.929 28.209,1.775c8.605,-1.285 26.499,-10.833 30.231,-21.295c3.732,-10.464 3.732,-19.431 2.612,-21.298c-1.119,-1.869 -4.105,-2.99 -8.583,-5.232Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share Birdsong and Song System on telegram"
            href="https://telegram.me/share/url?text=Birdsong%20and%20Song%20System&amp;url=https%3a%2f%2fflecart.github.io%2fnotes%2fbirdsong-and-song-system%2f">
            <svg version="1.1" xml:space="preserve" viewBox="2 2 28 28" height="30px" width="30px" fill="currentColor">
                <path
                    d="M26.49,29.86H5.5a3.37,3.37,0,0,1-2.47-1,3.35,3.35,0,0,1-1-2.47V5.48A3.36,3.36,0,0,1,3,3,3.37,3.37,0,0,1,5.5,2h21A3.38,3.38,0,0,1,29,3a3.36,3.36,0,0,1,1,2.46V26.37a3.35,3.35,0,0,1-1,2.47A3.38,3.38,0,0,1,26.49,29.86Zm-5.38-6.71a.79.79,0,0,0,.85-.66L24.73,9.24a.55.55,0,0,0-.18-.46.62.62,0,0,0-.41-.17q-.08,0-16.53,6.11a.59.59,0,0,0-.41.59.57.57,0,0,0,.43.52l4,1.24,1.61,4.83a.62.62,0,0,0,.63.43.56.56,0,0,0,.4-.17L16.54,20l4.09,3A.9.9,0,0,0,21.11,23.15ZM13.8,20.71l-1.21-4q8.72-5.55,8.78-5.55c.15,0,.23,0,.23.16a.18.18,0,0,1,0,.06s-2.51,2.3-7.52,6.8Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share Birdsong and Song System on ycombinator"
            href="https://news.ycombinator.com/submitlink?t=Birdsong%20and%20Song%20System&u=https%3a%2f%2fflecart.github.io%2fnotes%2fbirdsong-and-song-system%2f">
            <svg version="1.1" xml:space="preserve" width="30px" height="30px" viewBox="0 0 512 512" fill="currentColor"
                xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape">
                <path
                    d="M449.446 0C483.971 0 512 28.03 512 62.554L512 449.446C512 483.97 483.97 512 449.446 512L62.554 512C28.03 512 0 483.97 0 449.446L0 62.554C0 28.03 28.029 0 62.554 0L449.446 0ZM183.8767 87.9921H121.8427L230.6673 292.4508V424.0079H281.3328V292.4508L390.1575 87.9921H328.1233L256 238.2489z" />
            </svg>
        </a>
    </li>
</ul>

  </footer>
</article>
    </main>
    
<footer class="footer">
        <span>&copy; 2025 <a href="https://flecart.github.io/">X. Angelo Huang&#39;s Blog</a></span> · 

    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;

        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerHTML = 'copy';

        function copyingDone() {
            copybutton.innerHTML = 'copied!';
            setTimeout(() => {
                copybutton.innerHTML = 'copy';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                navigator.clipboard.writeText(codeblock.textContent);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) { };
            selection.removeRange(range);
        });

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
        } else if (container.parentNode.firstChild == container) {
            
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
        } else {
            
            codeblock.parentNode.appendChild(copybutton);
        }
    });
</script>
</body>

</html>
