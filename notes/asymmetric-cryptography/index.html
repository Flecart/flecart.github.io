<!DOCTYPE html>
<html lang="en" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>Asymmetric Cryptography | X. Angelo Huang&#39;s Blog</title>
<meta name="keywords" content="üõ°Ô∏ècybersecurity">
<meta name="description" content="Public Key Encryption We now define a formally what is a public key encryption
Formal definition of Public Key Encryption We define a 3-tuple formed as follows: $(G, E, D)$ where
$G$ is the generator for the private and public keys, from now on identified as $(pk, sk)$ (public key and secret key) $E$ the encryption algorithm, that takes the $pk$ and the message in input $D$ the decryption algorithm, that takes the $sk$ and the cyphertext in input.">
<meta name="author" content="Xuanqiang &#39;Angelo&#39; Huang">
<link rel="canonical" href="flecart.github.io/notes/asymmetric-cryptography/">
<link crossorigin="anonymous" href="flecart.github.io/assets/css/stylesheet.b609c58d5c11bb90b1a54e04005d74ad1ddf22165eb79f5533967e57df9c3b50.css" integrity="sha256-tgnFjVwRu5CxpU4EAF10rR3fIhZet59VM5Z&#43;V9&#43;cO1A=" rel="preload stylesheet" as="style">
<link rel="icon" href="/favicon-192x192.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="apple-touch-icon" href="/apple-touch-icon.png">
<link rel="mask-icon" href="flecart.github.io/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" hreflang="en" href="flecart.github.io/notes/asymmetric-cryptography/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --code-block-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript>


<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css" integrity="sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X" crossorigin="anonymous">
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.js" integrity="sha384-g7c+Jr9ZivxKLnZTDUhnkOnsh30B4H0rpLUpJ4jAIKs4fnJI+sEnkvrMWph2EDg4" crossorigin="anonymous"></script>
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/contrib/auto-render.min.js" integrity="sha384-mll67QQFJfxn0IYznZYonOWZ644AWYC+Pt2cHqMaRhXVrursRwvLnLaebdGIlYNa" crossorigin="anonymous"
    onload="renderMathInElement(document.body);"></script>


<script>
    document.addEventListener("DOMContentLoaded", function() {
        renderMathInElement(document.body, {
            delimiters: [
                {left: "$$", right: "$$", display: true},
                {left: "$", right: "$", display: false}
            ]
        });
    });
</script>


<script async src="https://www.googletagmanager.com/gtag/js?id=G-WW6NN2QGKF"></script>
<script>
var doNotTrack = false;
if (!doNotTrack) {
	window.dataLayer = window.dataLayer || [];
	function gtag(){dataLayer.push(arguments);}
	gtag('js', new Date());
	gtag('config', 'G-WW6NN2QGKF', { 'anonymize_ip': false });
}
</script>
<meta property="og:title" content="Asymmetric Cryptography" />
<meta property="og:description" content="Public Key Encryption We now define a formally what is a public key encryption
Formal definition of Public Key Encryption We define a 3-tuple formed as follows: $(G, E, D)$ where
$G$ is the generator for the private and public keys, from now on identified as $(pk, sk)$ (public key and secret key) $E$ the encryption algorithm, that takes the $pk$ and the message in input $D$ the decryption algorithm, that takes the $sk$ and the cyphertext in input." />
<meta property="og:type" content="article" />
<meta property="og:url" content="flecart.github.io/notes/asymmetric-cryptography/" />
<meta property="og:image" content="flecart.github.io/images/papermod-cover.png" />
<meta property="article:section" content="notes" />



<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:image" content="flecart.github.io/images/papermod-cover.png" />
<meta name="twitter:title" content="Asymmetric Cryptography"/>
<meta name="twitter:description" content="Public Key Encryption We now define a formally what is a public key encryption
Formal definition of Public Key Encryption We define a 3-tuple formed as follows: $(G, E, D)$ where
$G$ is the generator for the private and public keys, from now on identified as $(pk, sk)$ (public key and secret key) $E$ the encryption algorithm, that takes the $pk$ and the message in input $D$ the decryption algorithm, that takes the $sk$ and the cyphertext in input."/>


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Notes",
      "item": "flecart.github.io/notes/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "Asymmetric Cryptography",
      "item": "flecart.github.io/notes/asymmetric-cryptography/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "Asymmetric Cryptography",
  "name": "Asymmetric Cryptography",
  "description": "Public Key Encryption We now define a formally what is a public key encryption\nFormal definition of Public Key Encryption We define a 3-tuple formed as follows: $(G, E, D)$ where\n$G$ is the generator for the private and public keys, from now on identified as $(pk, sk)$ (public key and secret key) $E$ the encryption algorithm, that takes the $pk$ and the message in input $D$ the decryption algorithm, that takes the $sk$ and the cyphertext in input.",
  "keywords": [
    "üõ°Ô∏ècybersecurity"
  ],
  "articleBody": "Public Key Encryption We now define a formally what is a public key encryption\nFormal definition of Public Key Encryption We define a 3-tuple formed as follows: $(G, E, D)$ where\n$G$ is the generator for the private and public keys, from now on identified as $(pk, sk)$ (public key and secret key) $E$ the encryption algorithm, that takes the $pk$ and the message in input $D$ the decryption algorithm, that takes the $sk$ and the cyphertext in input. Now is this definition useful? i don‚Äôt think so! We can‚Äôt create theorems for it, too general I suppose. Is it clear? yes! I think this is the usefulness of maths in many occasions, it delivers some complex information in a concise and understandable manner.\nSome observations about Public Key Encryption Semantic security to Eavesdropping This is the same as explained in Advantage security explained in a previous section. We defined the advantage as the ability of the attacker to distinguish the original message. This is still exactly the same, see that section. (the only difference is that here we use public key encryption) Resistance against Many Time Pads We know that in the symmetric context in Block Ciphers and OTP and Stream Ciphers, it is often not secure to use the symmetric key to many times. (This is clearly true when we are talking about the OTP cipher).\nBut in the context of Asymmetric keys this notion is not true as the key is public, this key can be used as many times as the attacker wants. So he can reuse the key, while the cipher should still remain secure!\nTrapdoor functions Definition of Trapdoor functions This is a triple $G, F, F^{-1}$ very similar to the previous one (indeed it‚Äôs kinda the same definition) The only difference is that $F^{-1}$ is the inverse.\nSecure Trapdoor Functions üü®- NOTE: direct use of $F$ and $F^{-1}$ to encrypt and decrypt using the created keys is not secure.\nA trapdoor is secure if it‚Äôs difficult to invert without the knowledge of $sk$. See image Creating a PKE from Trapdoors üü®‚Äì One Way Hash Algorithms These are different from Hash tables which is a datastructure!\nWe can see that One-Way hashes are a trapdors with $pk = sk$. Usually it is a function that takes a input of arbitrary length and outputs a limited string with some important properties.\nProperties of One Way Hash Algorithms üü©- Easy to Evaluate: The hashing algorithm should be fast Hard to Reverse: There is no feasible algorithm to ‚Äúreverse‚Äù a hash value, That is, given any hash value $h$, it is computationally infeasible to find any document $m$ such that $H(m) = h$. Hard to find Collisions: There is no feasible algorithm to find two or more input documents which are hashed into the same condensed output, That is, it is computationally infeasible to find any two documents $m_{2}, m_{2}$ such that $H(m_{1})= H(m_{2})$. Although, theoretical requirements say there are many many collisions. But the difficult thing is tampering, that is add some strings, make some modifications of the original messages such that that hash matches with others. A small change to a message should change the hash value so extensively that the new hash value appears uncorrelated with the old hash value RSA Cryptosystem Definition of the trapdoor function We define $F: \\mathbb{Z}^{}_{\\mathbb{N}} \\to \\mathbb{Z}^{}_{\\mathbb{N}}$ as $RSA(x) = x^{e}$ where $e$ is the public key generated by the key generation function and $N = pq$ is the private key, where $p, q$ are big primes.\nThen using Euler‚Äôs theorem we know how to compute $d$ such that $x^{ed} =x \\mod N$ where $d$ is the inverse modulo that, this is how we decrypt. How do we compute $d$? We use euler‚Äôs theorem, and find this $e\\cdot d = 1 \\mod \\varphi(N)$. and $e$ should be invertible with it is coprime with $N$ (true by construction).\nSecurity Analysis of RSA NOTE: normal RSA as defined above is not secure.\nSimple semantic security attack on RSA I can get back to the original message with a small effort. The percentage of success is high enough not to be negligible.\n#### Advantage notation for RSA We want the possibility to compute the $e$ root modulo $N$ to be small, and using the notion of advantage developed in [OTP and Stream Ciphers#Security with advantage](//notes/otp-and-stream-ciphers#security-with-advantage) we write $$ Pr\\left[ A(N, e, y) = y ^{1/e} \\right] \u003c \\varepsilon $$ Where $\\varepsilon$ is very small, **negligible** so to say, and $A$ is the $F$ trapdoor function used for RSA. Wiener‚Äôs attack (non fatto) This section is not useful for the exam, just for personal knowledge! If the private keys have certain properties, there exists some attacks, one example is the Wiener‚Äôs attack Low public exponent attack üü© Usually minimum that is used is 3. If 2 then the inverse is not guaranteed because $mcd(2, (p - 1) ( q - 1)) \\neq 1$ .\nThis is a stupid attack. Then the exponent is small enough, and it is not able to wrap the module, then the root is quite easy to achieve. This is why the recommended value is big, usually = $2^{16} + 1 = 65537$.\nUsually this is used to speed up encryption, it easier to compute. Other variants, like Elgamal have almost same time to encrypt and decrypt.\nComparison with symmetric keys AES key size RSA modulus size 80 bit 1024 bits 128 bits 3072 bits 256 bits 15360 bits We observe that RSA needs a lot more bits to ensure the same security! Side channel attacks these attacks do not directly attack the cipher, but the infrastructure or computing that it uses.\nTiming attack Can leak $d$ secret key by tracking the compute time. (Kocher 1997)\nPower attack Can leak $d$ by tracking power usage. (Kocher 1999)\nFaults attack Errors can leak $d$ somehow (don‚Äôt know!) (BDL 1997). In questa fase viene leakato il valore di $p$ che permette di ricostruire la chiave privata.\nKey generation ### Variations #### Elgamal Find $g$ and $p$ such that $g$ is primitive root modulo $p$. Some strange properties here. This means that $\\forall a, \\exists k : g^{k} = a \\mod p$. This is inspired from the [Key Exchange protocols#Diffie-Hellman Protocol](//notes/key-exchange-protocols#diffie-hellman-protocol). Then the first person chooses $a \\in \\left[ 0, p - 2 \\right]$ randomly and calculates $A = g^{a} \\mod p$ and the tuple $(p , g, A)$ is then considered as the public key. When someone wants to send a message $m$, he/she does this: Chooses a $b$ in exact manner as before. Computes $c = A^{b}m \\mod p$ and sends this c. The receiver computes the inverse for this exponent, and then inverts $g^{b} \\mod p$ to calculate the original message $m$. Notes on security -\u003e Discrete log problem. Efficiency -\u003e No, ciphertext needs that public key to be sent, which is usually long and expensive to calculate compared to AES.\nRabin cryptosystem we create $p,q$ such that their modulus $4$ is 3, probably for some nice properties I don‚Äôt know of‚Ä¶ The advantage is that his security is prooved. Calculate $n = pq$ and this is the public key. When somebody wants to communicate, he just calculates\n$$ c = m^{2} \\mod n $$ And sends this, probably with this setting the properties of $p, q$ make that invertible, but not sure why. If you are curious try to understand why is this valid.\nDigital signatures The main idea is to cipher with the private key, so that it can be verifiable using the public. It was cited in Sicurezza delle reti times before. To overcome the burden to encrypt the whole text, usually only an hash is encrypted.\nAdvantages of Digital signatures Unforgeable Un-deniable by the signatory (if you have signed it, it was you!) Universally verifiable (everybody can verify it) Every doc‚Äôs signature is different. ",
  "wordCount" : "1310",
  "inLanguage": "en",
  "image": "flecart.github.io/images/papermod-cover.png","datePublished": "0001-01-01T00:00:00Z",
  "dateModified": "0001-01-01T00:00:00Z",
  "author":{
    "@type": "Person",
    "name": "Xuanqiang 'Angelo' Huang"
  },
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "flecart.github.io/notes/asymmetric-cryptography/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "X. Angelo Huang's Blog",
    "logo": {
      "@type": "ImageObject",
      "url": "/favicon-192x192.png"
    }
  }
}
</script>
</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="flecart.github.io/" accesskey="h" title="X. Angelo Huang&#39;s Blog (Alt + H)">X. Angelo Huang&#39;s Blog</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="flecart.github.io/flecart.github.io/notes/" title="Notes">
                    <span>Notes</span>
                </a>
            </li>
            <li>
                <a href="flecart.github.io/archives" title="Archive">
                    <span>Archive</span>
                </a>
            </li>
            <li>
                <a href="flecart.github.io/search/" title="Search (Alt &#43; /)" accesskey=/>
                    <span>Search</span>
                </a>
            </li>
            <li>
                <a href="flecart.github.io/tags/" title="Tags">
                    <span>Tags</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    <div class="breadcrumbs"><a href="flecart.github.io/">Home</a>&nbsp;¬ª&nbsp;<a href="flecart.github.io/notes/">Notes</a></div>
    <h1 class="post-title entry-hint-parent">
      Asymmetric Cryptography
    </h1>
    <div class="post-meta">7 min&nbsp;¬∑&nbsp;Xuanqiang &#39;Angelo&#39; Huang

</div>
  </header> <div class="toc">
    <details >
        <summary accesskey="c" title="(Alt + C)">
            <span class="details">Table of Contents</span>
        </summary>

        <div class="inner"><ul>
                <li>
                    <a href="#public-key-encryption" aria-label="Public Key Encryption">Public Key Encryption</a><ul>
                        
                <li>
                    <a href="#formal-definition-of-public-key-encryption" aria-label="Formal definition of Public Key Encryption">Formal definition of Public Key Encryption</a></li>
                <li>
                    <a href="#some-observations-about-public-key-encryption" aria-label="Some observations about Public Key Encryption">Some observations about Public Key Encryption</a><ul>
                        
                <li>
                    <a href="#semantic-security-to-eavesdropping" aria-label="Semantic security to Eavesdropping">Semantic security to Eavesdropping</a></li>
                <li>
                    <a href="#resistance-against-many-time-pads" aria-label="Resistance against Many Time Pads">Resistance against Many Time Pads</a></li></ul>
                </li></ul>
                </li>
                <li>
                    <a href="#trapdoor-functions" aria-label="Trapdoor functions">Trapdoor functions</a><ul>
                        
                <li>
                    <a href="#definition-of-trapdoor-functions" aria-label="Definition of Trapdoor functions">Definition of Trapdoor functions</a><ul>
                        
                <li>
                    <a href="#secure-trapdoor-functions--" aria-label="Secure Trapdoor Functions üü®-">Secure Trapdoor Functions üü®-</a></li>
                <li>
                    <a href="#creating-a-pke-from-trapdoors---" aria-label="Creating a PKE from Trapdoors üü®&ndash;">Creating a PKE from Trapdoors üü®&ndash;</a></li></ul>
                </li>
                <li>
                    <a href="#one-way-hash-algorithms" aria-label="One Way Hash Algorithms">One Way Hash Algorithms</a><ul>
                        
                <li>
                    <a href="#properties-of-one-way-hash-algorithms--" aria-label="Properties of One Way Hash Algorithms üü©-">Properties of One Way Hash Algorithms üü©-</a></li></ul>
                </li></ul>
                </li>
                <li>
                    <a href="#rsa-cryptosystem" aria-label="RSA Cryptosystem">RSA Cryptosystem</a><ul>
                        
                <li>
                    <a href="#definition-of-the-trapdoor-function" aria-label="Definition of the trapdoor function">Definition of the trapdoor function</a></li>
                <li>
                    <a href="#security-analysis-of-rsa" aria-label="Security Analysis of RSA">Security Analysis of RSA</a><ul>
                        
                <li>
                    <a href="#simple-semantic-security-attack-on-rsa" aria-label="Simple semantic security attack on RSA">Simple semantic security attack on RSA</a></li>
                <li>
                    <a href="#wieners-attack-non-fatto" aria-label="Wiener&rsquo;s attack (non fatto)">Wiener&rsquo;s attack (non fatto)</a></li>
                <li>
                    <a href="#low-public-exponent-attack-" aria-label="Low public exponent attack üü©">Low public exponent attack üü©</a></li>
                <li>
                    <a href="#comparison-with-symmetric-keys" aria-label="Comparison with symmetric keys">Comparison with symmetric keys</a></li></ul>
                </li>
                <li>
                    <a href="#side-channel-attacks" aria-label="Side channel attacks">Side channel attacks</a><ul>
                        
                <li>
                    <a href="#timing-attack" aria-label="Timing attack">Timing attack</a></li>
                <li>
                    <a href="#power-attack" aria-label="Power attack">Power attack</a></li>
                <li>
                    <a href="#faults-attack" aria-label="Faults attack">Faults attack</a></li>
                <li>
                    <a href="#key-generation" aria-label="Key generation">Key generation</a></li>
                <li>
                    <a href="#rabin-cryptosystem" aria-label="Rabin cryptosystem">Rabin cryptosystem</a></li></ul>
                </li></ul>
                </li>
                <li>
                    <a href="#digital-signatures" aria-label="Digital signatures">Digital signatures</a><ul>
                        
                <li>
                    <a href="#advantages-of-digital-signatures" aria-label="Advantages of Digital signatures">Advantages of Digital signatures</a>
                </li>
            </ul>
            </li>
            </ul>
        </div>
    </details>
</div>

  <div class="post-content"><h2 id="public-key-encryption">Public Key Encryption<a hidden class="anchor" aria-hidden="true" href="#public-key-encryption">#</a></h2>
<p>We now define a formally what is a  public key encryption</p>
<h3 id="formal-definition-of-public-key-encryption">Formal definition of Public Key Encryption<a hidden class="anchor" aria-hidden="true" href="#formal-definition-of-public-key-encryption">#</a></h3>
<p>We define a 3-tuple formed as follows: $(G, E, D)$ where</p>
<ul>
<li>$G$ is the generator for the private and public keys, from now on identified as $(pk, sk)$ (public key and secret key)</li>
<li>$E$ the encryption algorithm, that takes the $pk$ and the message in input</li>
<li>$D$ the decryption algorithm, that takes the $sk$ and the cyphertext in input.</li>
</ul>
<p>Now is this definition useful? i don&rsquo;t think so! We can&rsquo;t create theorems for it, too general I suppose. Is it clear? yes! I think this is the usefulness of maths in many occasions, it delivers some complex information in a concise and understandable manner.</p>
<h3 id="some-observations-about-public-key-encryption">Some observations about Public Key Encryption<a hidden class="anchor" aria-hidden="true" href="#some-observations-about-public-key-encryption">#</a></h3>
<h4 id="semantic-security-to-eavesdropping">Semantic security to Eavesdropping<a hidden class="anchor" aria-hidden="true" href="#semantic-security-to-eavesdropping">#</a></h4>
<p>This is the same as explained in <a href="//notes/otp-and-stream-ciphers#security-with-advantage">Advantage security</a> explained in a previous section.
We defined the advantage as the ability of the attacker to distinguish the original message. This is still exactly the same, see that section. (the only difference is that here we use public key encryption)
<img src="/images/notes/Asymmetric Cryptography-20240402230103858.webp" alt="Asymmetric Cryptography-20240402230103858"></p>
<h4 id="resistance-against-many-time-pads">Resistance against Many Time Pads<a hidden class="anchor" aria-hidden="true" href="#resistance-against-many-time-pads">#</a></h4>
<p>We know that in the symmetric context in <a href="//notes/block-ciphers">Block Ciphers</a> and <a href="//notes/otp-and-stream-ciphers">OTP and Stream Ciphers</a>, it is often not secure to use the symmetric key to many times. (This is clearly true when we are talking about the OTP cipher).</p>
<p>But in the context of Asymmetric keys this notion is <em>not true</em> as the key is public, this key can be used as many times as the attacker wants. So he can reuse the key, while the cipher should still remain secure!</p>
<h2 id="trapdoor-functions">Trapdoor functions<a hidden class="anchor" aria-hidden="true" href="#trapdoor-functions">#</a></h2>
<h3 id="definition-of-trapdoor-functions">Definition of Trapdoor functions<a hidden class="anchor" aria-hidden="true" href="#definition-of-trapdoor-functions">#</a></h3>
<p>This is a triple $G, F, F^{-1}$ very similar to the previous one (indeed it&rsquo;s kinda the same definition) The only difference is that $F^{-1}$ is the inverse.</p>
<h4 id="secure-trapdoor-functions--">Secure Trapdoor Functions üü®-<a hidden class="anchor" aria-hidden="true" href="#secure-trapdoor-functions--">#</a></h4>
<p>NOTE: direct use of $F$ and $F^{-1}$ to encrypt and decrypt using the created keys is not secure.</p>
<p>A trapdoor is secure if it&rsquo;s difficult to invert without the knowledge of $sk$.
See image
<img src="/images/notes/Asymmetric Cryptography-20240319111432568.jpg" alt="Asymmetric Cryptography-20240319111432568"></p>
<h4 id="creating-a-pke-from-trapdoors---">Creating a PKE from Trapdoors üü®&ndash;<a hidden class="anchor" aria-hidden="true" href="#creating-a-pke-from-trapdoors---">#</a></h4>
<img src="/images/notes/Asymmetric Cryptography-20240319101427775.jpg" alt="Asymmetric Cryptography-20240319101427775">
<h3 id="one-way-hash-algorithms">One Way Hash Algorithms<a hidden class="anchor" aria-hidden="true" href="#one-way-hash-algorithms">#</a></h3>
<p>These are different from <a href="//notes/tabelle-di-hash">Hash tables</a> which is a datastructure!</p>
<p>We can see that One-Way hashes are a trapdors with $pk = sk$.
Usually it is a function that takes a input of arbitrary length and outputs a limited string with some important properties.</p>
<h4 id="properties-of-one-way-hash-algorithms--">Properties of One Way Hash Algorithms üü©-<a hidden class="anchor" aria-hidden="true" href="#properties-of-one-way-hash-algorithms--">#</a></h4>
<ol>
<li>Easy to Evaluate:
The hashing algorithm should be fast</li>
<li>Hard to Reverse:
There is no feasible algorithm to &ldquo;reverse&rdquo; a hash value,
That is, given any hash value $h$, it is computationally infeasible to find any document $m$ such that $H(m) = h$.</li>
<li>Hard to find Collisions:
There is no feasible algorithm to find two or more input documents which are hashed into the same condensed output,
That is, it is computationally infeasible to find any two documents $m_{2}, m_{2}$ such that $H(m_{1})= H(m_{2})$.
Although, theoretical requirements say there are many many collisions. But the difficult thing is tampering, that is add some strings, make some modifications of the original messages such that that hash matches with others.</li>
<li>A small change to a message should change the hash value so extensively that the new hash value appears uncorrelated with the old hash value</li>
</ol>
<h2 id="rsa-cryptosystem">RSA Cryptosystem<a hidden class="anchor" aria-hidden="true" href="#rsa-cryptosystem">#</a></h2>
<h3 id="definition-of-the-trapdoor-function">Definition of the trapdoor function<a hidden class="anchor" aria-hidden="true" href="#definition-of-the-trapdoor-function">#</a></h3>
<p>We define $F: \mathbb{Z}^{<em>}_{\mathbb{N}} \to \mathbb{Z}^{</em>}_{\mathbb{N}}$ as $RSA(x) = x^{e}$  where $e$ is the public key generated by the key generation function and $N = pq$ is the private key, where $p, q$ are big primes.</p>
<p>Then using <a href="//notes/teorema-di-lagrange#teorema-di-eulero">Euler&rsquo;s theorem</a> we know how to compute $d$ such that $x^{ed} =x \mod N$ where $d$ is the inverse modulo that, this is how we decrypt.
How do we compute $d$? We use euler&rsquo;s theorem, and find this $e\cdot d = 1 \mod \varphi(N)$. and $e$ should be invertible with it is coprime with $N$ (true by construction).</p>
<h3 id="security-analysis-of-rsa">Security Analysis of RSA<a hidden class="anchor" aria-hidden="true" href="#security-analysis-of-rsa">#</a></h3>
<p>NOTE: normal RSA as defined above is not secure.</p>
<h4 id="simple-semantic-security-attack-on-rsa">Simple semantic security attack on RSA<a hidden class="anchor" aria-hidden="true" href="#simple-semantic-security-attack-on-rsa">#</a></h4>
<p>I can get back to the original message with a small effort. The percentage of success is high enough not to be negligible.</p>
<img src="/images/notes/Asymmetric Cryptography-20240319114920695.jpg" alt="Asymmetric Cryptography-20240319114920695">
#### Advantage notation for RSA
We want the possibility to compute the $e$ root modulo $N$ to be small, and using the notion of advantage developed in [OTP and Stream Ciphers#Security with advantage](//notes/otp-and-stream-ciphers#security-with-advantage) we write
$$
Pr\left[ A(N, e, y) = y ^{1/e} \right] < \varepsilon
$$
Where $\varepsilon$ is very small, **negligible** so to say, and $A$ is the $F$ trapdoor function used for RSA.
<h4 id="wieners-attack-non-fatto">Wiener&rsquo;s attack (non fatto)<a hidden class="anchor" aria-hidden="true" href="#wieners-attack-non-fatto">#</a></h4>
<p>This section is not useful for the exam, just for personal knowledge!
If the private keys have certain properties, there exists some attacks, one example is the Wiener&rsquo;s attack
<img src="/images/notes/Asymmetric Cryptography-20240321101500213.webp" alt="Asymmetric Cryptography-20240321101500213"></p>
<h4 id="low-public-exponent-attack-">Low public exponent attack üü©<a hidden class="anchor" aria-hidden="true" href="#low-public-exponent-attack-">#</a></h4>
<p>Usually minimum that is used is 3. If 2 then the inverse is not guaranteed because $mcd(2, (p - 1) ( q - 1)) \neq 1$ .</p>
<p>This is a stupid attack. Then the exponent is small enough, and it is not able to wrap the module, then the root is quite easy to achieve.
This is why the <strong>recommended value</strong> is big, usually = $2^{16} + 1 = 65537$.</p>
<p>Usually this is used to <strong>speed up</strong> encryption, it easier to compute. Other variants, like <em>Elgamal</em> have almost same time to encrypt and decrypt.</p>
<h4 id="comparison-with-symmetric-keys">Comparison with symmetric keys<a hidden class="anchor" aria-hidden="true" href="#comparison-with-symmetric-keys">#</a></h4>
<table>
<thead>
<tr>
<th>AES key size</th>
<th>RSA modulus size</th>
</tr>
</thead>
<tbody>
<tr>
<td>80 bit</td>
<td>1024 bits</td>
</tr>
<tr>
<td>128 bits</td>
<td>3072 bits</td>
</tr>
<tr>
<td>256 bits</td>
<td>15360 bits</td>
</tr>
<tr>
<td>We observe that RSA needs a lot more bits to ensure the same security!</td>
<td></td>
</tr>
</tbody>
</table>
<h3 id="side-channel-attacks">Side channel attacks<a hidden class="anchor" aria-hidden="true" href="#side-channel-attacks">#</a></h3>
<p>these attacks do not directly attack the cipher, but the infrastructure or computing that it uses.</p>
<h4 id="timing-attack">Timing attack<a hidden class="anchor" aria-hidden="true" href="#timing-attack">#</a></h4>
<p>Can leak $d$ secret key by tracking the compute time. (Kocher 1997)</p>
<h4 id="power-attack">Power attack<a hidden class="anchor" aria-hidden="true" href="#power-attack">#</a></h4>
<p>Can leak $d$ by tracking power usage. (Kocher 1999)</p>
<h4 id="faults-attack">Faults attack<a hidden class="anchor" aria-hidden="true" href="#faults-attack">#</a></h4>
<p>Errors can leak $d$ somehow (don&rsquo;t know!) (BDL 1997).
<img src="/images/notes/Asymmetric Cryptography-20240321110527763.webp" width="481" alt="Asymmetric Cryptography-20240321110527763">
In questa fase viene leakato il valore di $p$ che permette di ricostruire la chiave privata.</p>
<h4 id="key-generation">Key generation<a hidden class="anchor" aria-hidden="true" href="#key-generation">#</a></h4>
<img src="/images/notes/Asymmetric Cryptography-20240321110517713.webp" alt="Asymmetric Cryptography-20240321110517713">
### Variations
#### Elgamal
Find $g$ and $p$ such that $g$ is primitive root modulo $p$. Some strange properties here.
This means that $\forall a, \exists k : g^{k} = a  \mod p$. This is inspired from the [Key Exchange protocols#Diffie-Hellman Protocol](//notes/key-exchange-protocols#diffie-hellman-protocol).
Then the first person chooses $a \in \left[ 0, p - 2 \right]$ randomly and calculates $A = g^{a} \mod p$ and the tuple $(p , g, A)$ is then considered as the public key.
When someone wants to send a message $m$, he/she does this:
Chooses a $b$ in exact manner as before.
Computes $c = A^{b}m \mod p$ and sends this c.
The receiver computes the inverse for this exponent, and then inverts $g^{b} \mod p$ to calculate the original message $m$.
<p>Notes on security -&gt; <strong>Discrete log problem</strong>.
Efficiency -&gt; No, ciphertext needs that public key to be sent, which is usually long and expensive to calculate compared to AES.</p>
<h4 id="rabin-cryptosystem">Rabin cryptosystem<a hidden class="anchor" aria-hidden="true" href="#rabin-cryptosystem">#</a></h4>
<p>we create $p,q$ such that their modulus $4$ is 3, probably for some nice properties I don&rsquo;t know of&hellip;
The advantage is that his security is prooved.
Calculate $n = pq$ and this is the public key.
When somebody wants to communicate, he just calculates</p>
<p>$$
c = m^{2} \mod  n
$$
And sends this, probably with this setting the properties of $p, q$ make that invertible, but not sure why.
<img src="/images/notes/Asymmetric Cryptography-20240402233238657.webp" alt="Asymmetric Cryptography-20240402233238657">
If you are curious try to understand why is this valid.</p>
<h2 id="digital-signatures">Digital signatures<a hidden class="anchor" aria-hidden="true" href="#digital-signatures">#</a></h2>
<p>The main idea is to cipher with the private key, so that it can be verifiable using the public.
It was cited in <a href="//notes/sicurezza-delle-reti">Sicurezza delle reti</a> times before.
To overcome the burden to encrypt the whole text, usually only an hash is encrypted.</p>
<h3 id="advantages-of-digital-signatures">Advantages of Digital signatures<a hidden class="anchor" aria-hidden="true" href="#advantages-of-digital-signatures">#</a></h3>
<ul>
<li><strong>Unforgeable</strong></li>
<li><strong>Un-deniable</strong> by the signatory (if you have signed it, it was you!)</li>
<li><strong>Universally verifiable</strong> (everybody can verify it)</li>
<li>Every doc&rsquo;s signature is <strong>different</strong>.</li>
</ul>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="flecart.github.io/tags/%EF%B8%8Fcybersecurity/">üõ°Ô∏èCybersecurity</a></li>
    </ul>


<ul class="share-buttons">
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share Asymmetric Cryptography on x"
            href="https://x.com/intent/tweet/?text=Asymmetric%20Cryptography&amp;url=flecart.github.io%2fnotes%2fasymmetric-cryptography%2f&amp;hashtags=%f0%9f%9b%a1%ef%b8%8fcybersecurity">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M512 62.554 L 512 449.446 C 512 483.97 483.97 512 449.446 512 L 62.554 512 C 28.03 512 0 483.97 0 449.446 L 0 62.554 C 0 28.03 28.029 0 62.554 0 L 449.446 0 C 483.971 0 512 28.03 512 62.554 Z M 269.951 190.75 L 182.567 75.216 L 56 75.216 L 207.216 272.95 L 63.9 436.783 L 125.266 436.783 L 235.9 310.383 L 332.567 436.783 L 456 436.783 L 298.367 228.367 L 432.367 75.216 L 371.033 75.216 Z M 127.633 110 L 164.101 110 L 383.481 400.065 L 349.5 400.065 Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share Asymmetric Cryptography on linkedin"
            href="https://www.linkedin.com/shareArticle?mini=true&amp;url=flecart.github.io%2fnotes%2fasymmetric-cryptography%2f&amp;title=Asymmetric%20Cryptography&amp;summary=Asymmetric%20Cryptography&amp;source=flecart.github.io%2fnotes%2fasymmetric-cryptography%2f">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-288.985,423.278l0,-225.717l-75.04,0l0,225.717l75.04,0Zm270.539,0l0,-129.439c0,-69.333 -37.018,-101.586 -86.381,-101.586c-39.804,0 -57.634,21.891 -67.617,37.266l0,-31.958l-75.021,0c0.995,21.181 0,225.717 0,225.717l75.02,0l0,-126.056c0,-6.748 0.486,-13.492 2.474,-18.315c5.414,-13.475 17.767,-27.434 38.494,-27.434c27.135,0 38.007,20.707 38.007,51.037l0,120.768l75.024,0Zm-307.552,-334.556c-25.674,0 -42.448,16.879 -42.448,39.002c0,21.658 16.264,39.002 41.455,39.002l0.484,0c26.165,0 42.452,-17.344 42.452,-39.002c-0.485,-22.092 -16.241,-38.954 -41.943,-39.002Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share Asymmetric Cryptography on reddit"
            href="https://reddit.com/submit?url=flecart.github.io%2fnotes%2fasymmetric-cryptography%2f&title=Asymmetric%20Cryptography">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-3.446,265.638c0,-22.964 -18.616,-41.58 -41.58,-41.58c-11.211,0 -21.361,4.457 -28.841,11.666c-28.424,-20.508 -67.586,-33.757 -111.204,-35.278l18.941,-89.121l61.884,13.157c0.756,15.734 13.642,28.29 29.56,28.29c16.407,0 29.706,-13.299 29.706,-29.701c0,-16.403 -13.299,-29.702 -29.706,-29.702c-11.666,0 -21.657,6.792 -26.515,16.578l-69.105,-14.69c-1.922,-0.418 -3.939,-0.042 -5.585,1.036c-1.658,1.073 -2.811,2.761 -3.224,4.686l-21.152,99.438c-44.258,1.228 -84.046,14.494 -112.837,35.232c-7.468,-7.164 -17.589,-11.591 -28.757,-11.591c-22.965,0 -41.585,18.616 -41.585,41.58c0,16.896 10.095,31.41 24.568,37.918c-0.639,4.135 -0.99,8.328 -0.99,12.576c0,63.977 74.469,115.836 166.33,115.836c91.861,0 166.334,-51.859 166.334,-115.836c0,-4.218 -0.347,-8.387 -0.977,-12.493c14.564,-6.47 24.735,-21.034 24.735,-38.001Zm-119.474,108.193c-20.27,20.241 -59.115,21.816 -70.534,21.816c-11.428,0 -50.277,-1.575 -70.522,-21.82c-3.007,-3.008 -3.007,-7.882 0,-10.889c3.003,-2.999 7.882,-3.003 10.885,0c12.777,12.781 40.11,17.317 59.637,17.317c19.522,0 46.86,-4.536 59.657,-17.321c3.016,-2.999 7.886,-2.995 10.885,0.008c3.008,3.011 3.003,7.882 -0.008,10.889Zm-5.23,-48.781c-16.373,0 -29.701,-13.324 -29.701,-29.698c0,-16.381 13.328,-29.714 29.701,-29.714c16.378,0 29.706,13.333 29.706,29.714c0,16.374 -13.328,29.698 -29.706,29.698Zm-160.386,-29.702c0,-16.381 13.328,-29.71 29.714,-29.71c16.369,0 29.689,13.329 29.689,29.71c0,16.373 -13.32,29.693 -29.689,29.693c-16.386,0 -29.714,-13.32 -29.714,-29.693Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share Asymmetric Cryptography on facebook"
            href="https://facebook.com/sharer/sharer.php?u=flecart.github.io%2fnotes%2fasymmetric-cryptography%2f">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-106.468,0l0,-192.915l66.6,0l12.672,-82.621l-79.272,0l0,-53.617c0,-22.603 11.073,-44.636 46.58,-44.636l36.042,0l0,-70.34c0,0 -32.71,-5.582 -63.982,-5.582c-65.288,0 -107.96,39.569 -107.96,111.204l0,62.971l-72.573,0l0,82.621l72.573,0l0,192.915l-191.104,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share Asymmetric Cryptography on whatsapp"
            href="https://api.whatsapp.com/send?text=Asymmetric%20Cryptography%20-%20flecart.github.io%2fnotes%2fasymmetric-cryptography%2f">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-58.673,127.703c-33.842,-33.881 -78.847,-52.548 -126.798,-52.568c-98.799,0 -179.21,80.405 -179.249,179.234c-0.013,31.593 8.241,62.428 23.927,89.612l-25.429,92.884l95.021,-24.925c26.181,14.28 55.659,21.807 85.658,21.816l0.074,0c98.789,0 179.206,-80.413 179.247,-179.243c0.018,-47.895 -18.61,-92.93 -52.451,-126.81Zm-126.797,275.782l-0.06,0c-26.734,-0.01 -52.954,-7.193 -75.828,-20.767l-5.441,-3.229l-56.386,14.792l15.05,-54.977l-3.542,-5.637c-14.913,-23.72 -22.791,-51.136 -22.779,-79.287c0.033,-82.142 66.867,-148.971 149.046,-148.971c39.793,0.014 77.199,15.531 105.329,43.692c28.128,28.16 43.609,65.592 43.594,105.4c-0.034,82.149 -66.866,148.983 -148.983,148.984Zm81.721,-111.581c-4.479,-2.242 -26.499,-13.075 -30.604,-14.571c-4.105,-1.495 -7.091,-2.241 -10.077,2.241c-2.986,4.483 -11.569,14.572 -14.182,17.562c-2.612,2.988 -5.225,3.364 -9.703,1.12c-4.479,-2.241 -18.91,-6.97 -36.017,-22.23c-13.314,-11.876 -22.304,-26.542 -24.916,-31.026c-2.612,-4.484 -0.279,-6.908 1.963,-9.14c2.016,-2.007 4.48,-5.232 6.719,-7.847c2.24,-2.615 2.986,-4.484 4.479,-7.472c1.493,-2.99 0.747,-5.604 -0.374,-7.846c-1.119,-2.241 -10.077,-24.288 -13.809,-33.256c-3.635,-8.733 -7.327,-7.55 -10.077,-7.688c-2.609,-0.13 -5.598,-0.158 -8.583,-0.158c-2.986,0 -7.839,1.121 -11.944,5.604c-4.105,4.484 -15.675,15.32 -15.675,37.364c0,22.046 16.048,43.342 18.287,46.332c2.24,2.99 31.582,48.227 76.511,67.627c10.685,4.615 19.028,7.371 25.533,9.434c10.728,3.41 20.492,2.929 28.209,1.775c8.605,-1.285 26.499,-10.833 30.231,-21.295c3.732,-10.464 3.732,-19.431 2.612,-21.298c-1.119,-1.869 -4.105,-2.99 -8.583,-5.232Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share Asymmetric Cryptography on telegram"
            href="https://telegram.me/share/url?text=Asymmetric%20Cryptography&amp;url=flecart.github.io%2fnotes%2fasymmetric-cryptography%2f">
            <svg version="1.1" xml:space="preserve" viewBox="2 2 28 28" height="30px" width="30px" fill="currentColor">
                <path
                    d="M26.49,29.86H5.5a3.37,3.37,0,0,1-2.47-1,3.35,3.35,0,0,1-1-2.47V5.48A3.36,3.36,0,0,1,3,3,3.37,3.37,0,0,1,5.5,2h21A3.38,3.38,0,0,1,29,3a3.36,3.36,0,0,1,1,2.46V26.37a3.35,3.35,0,0,1-1,2.47A3.38,3.38,0,0,1,26.49,29.86Zm-5.38-6.71a.79.79,0,0,0,.85-.66L24.73,9.24a.55.55,0,0,0-.18-.46.62.62,0,0,0-.41-.17q-.08,0-16.53,6.11a.59.59,0,0,0-.41.59.57.57,0,0,0,.43.52l4,1.24,1.61,4.83a.62.62,0,0,0,.63.43.56.56,0,0,0,.4-.17L16.54,20l4.09,3A.9.9,0,0,0,21.11,23.15ZM13.8,20.71l-1.21-4q8.72-5.55,8.78-5.55c.15,0,.23,0,.23.16a.18.18,0,0,1,0,.06s-2.51,2.3-7.52,6.8Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share Asymmetric Cryptography on ycombinator"
            href="https://news.ycombinator.com/submitlink?t=Asymmetric%20Cryptography&u=flecart.github.io%2fnotes%2fasymmetric-cryptography%2f">
            <svg version="1.1" xml:space="preserve" width="30px" height="30px" viewBox="0 0 512 512" fill="currentColor"
                xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape">
                <path
                    d="M449.446 0C483.971 0 512 28.03 512 62.554L512 449.446C512 483.97 483.97 512 449.446 512L62.554 512C28.03 512 0 483.97 0 449.446L0 62.554C0 28.03 28.029 0 62.554 0L449.446 0ZM183.8767 87.9921H121.8427L230.6673 292.4508V424.0079H281.3328V292.4508L390.1575 87.9921H328.1233L256 238.2489z" />
            </svg>
        </a>
    </li>
</ul>

  </footer>
</article>
    </main>
    
<footer class="footer">
    <span>&copy; 2024 <a href="flecart.github.io/">X. Angelo Huang&#39;s Blog</a></span>
    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;

        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerHTML = 'copy';

        function copyingDone() {
            copybutton.innerHTML = 'copied!';
            setTimeout(() => {
                copybutton.innerHTML = 'copy';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                navigator.clipboard.writeText(codeblock.textContent);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) { };
            selection.removeRange(range);
        });

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
        } else if (container.parentNode.firstChild == container) {
            
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
        } else {
            
            codeblock.parentNode.appendChild(copybutton);
        }
    });
</script>
</body>

</html>
