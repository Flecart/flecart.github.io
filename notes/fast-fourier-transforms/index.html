<!DOCTYPE html>
<html lang="en" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>Fast Fourier Transforms | X. Angelo Huang&#39;s Blog</title>
<meta name="keywords" content="advanced-systems-lab">
<meta name="description" content="The algorithm has been the same, some ideas are in Fourier Series, but architectures change, which means there are new ways to make this algorithm even faster.
Example of transforms
We have learned in Algebra lineare numerica, Cambio di Base that linear transforms are usually a change of basis. They are matrix vector multiplications (additions and multiplications by constants). The optimizations are based on what sorts of transforms we have (e.g. Sparse Matrix Vector Multiplication, or dense versions).
The same idea applies also for Fourier transforms.">
<meta name="author" content="
By Xuanqiang Angelo Huang">
<link rel="canonical" href="https://flecart.github.io/notes/fast-fourier-transforms/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.f790d9af969c56c079c1ce2d5972a04486bf3d6144295d5fba319830e1e55a7a.css" integrity="sha256-95DZr5acVsB5wc4tWXKgRIa/PWFEKV1fujGYMOHlWno=" rel="preload stylesheet" as="style">
<link rel="icon" href="https://flecart.github.io/favicon-192x192.png">
<link rel="icon" type="image/png" sizes="16x16" href="https://flecart.github.io/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://flecart.github.io/favicon-32x32.png">
<link rel="apple-touch-icon" href="https://flecart.github.io/apple-touch-icon.png">
<link rel="mask-icon" href="https://flecart.github.io/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" hreflang="en" href="https://flecart.github.io/notes/fast-fourier-transforms/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --code-block-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript>



<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"] ],
        processEscapes: true
      }
    });
  </script>
<script type="text/javascript" async
src="//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>






      <script async src="https://www.googletagmanager.com/gtag/js?id=G-WW6NN2QGKF"></script>
      <script>
        var doNotTrack = false;
        if ( false ) {
          var dnt = (navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack);
          var doNotTrack = (dnt == "1" || dnt == "yes");
        }
        if (!doNotTrack) {
          window.dataLayer = window.dataLayer || [];
          function gtag(){dataLayer.push(arguments);}
          gtag('js', new Date());
          gtag('config', 'G-WW6NN2QGKF');
        }
      </script><meta property="og:url" content="https://flecart.github.io/notes/fast-fourier-transforms/">
  <meta property="og:site_name" content="X. Angelo Huang&#39;s Blog">
  <meta property="og:title" content="Fast Fourier Transforms">
  <meta property="og:description" content="The algorithm has been the same, some ideas are in Fourier Series, but architectures change, which means there are new ways to make this algorithm even faster.
Example of transforms We have learned in Algebra lineare numerica, Cambio di Base that linear transforms are usually a change of basis. They are matrix vector multiplications (additions and multiplications by constants). The optimizations are based on what sorts of transforms we have (e.g. Sparse Matrix Vector Multiplication, or dense versions). The same idea applies also for Fourier transforms.">
  <meta property="og:locale" content="en">
  <meta property="og:type" content="article">
    <meta property="article:section" content="notes">
    <meta property="article:published_time" content="2025-04-07T00:00:00+00:00">
    <meta property="article:modified_time" content="2025-04-07T00:00:00+00:00">
    <meta property="article:tag" content="Advanced-Systems-Lab">
      <meta property="og:image" content="https://flecart.github.io/images/papermod-cover.png">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="https://flecart.github.io/images/papermod-cover.png">
<meta name="twitter:title" content="Fast Fourier Transforms">
<meta name="twitter:description" content="The algorithm has been the same, some ideas are in Fourier Series, but architectures change, which means there are new ways to make this algorithm even faster.
Example of transforms
We have learned in Algebra lineare numerica, Cambio di Base that linear transforms are usually a change of basis. They are matrix vector multiplications (additions and multiplications by constants). The optimizations are based on what sorts of transforms we have (e.g. Sparse Matrix Vector Multiplication, or dense versions).
The same idea applies also for Fourier transforms.">


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Notes",
      "item": "https://flecart.github.io/notes/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "Fast Fourier Transforms",
      "item": "https://flecart.github.io/notes/fast-fourier-transforms/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "Fast Fourier Transforms",
  "name": "Fast Fourier Transforms",
  "description": "The algorithm has been the same, some ideas are in Fourier Series, but architectures change, which means there are new ways to make this algorithm even faster.\nExample of transforms We have learned in Algebra lineare numerica, Cambio di Base that linear transforms are usually a change of basis. They are matrix vector multiplications (additions and multiplications by constants). The optimizations are based on what sorts of transforms we have (e.g. Sparse Matrix Vector Multiplication, or dense versions). The same idea applies also for Fourier transforms.\n",
  "keywords": [
    "advanced-systems-lab"
  ],
  "articleBody": "The algorithm has been the same, some ideas are in Fourier Series, but architectures change, which means there are new ways to make this algorithm even faster.\nExample of transforms We have learned in Algebra lineare numerica, Cambio di Base that linear transforms are usually a change of basis. They are matrix vector multiplications (additions and multiplications by constants). The optimizations are based on what sorts of transforms we have (e.g. Sparse Matrix Vector Multiplication, or dense versions). The same idea applies also for Fourier transforms.\nDiscrete Fourier Transforms Primitive roots It uses primitive roots of $n$ as coefficients. Discrete Fourier transform computes:\n$$ \\begin{align*}\ny_{k} \u0026= \\sum_{l = 0} ^{n-1} x_{l} \\cdot e^{-2 \\pi i \\frac{kl}{n}}\\ \u0026= \\sum_{l = 0} ^{n-1} x_{l} \\cdot \\omega^{kl}\\ \\end{align*} $$\nWhere $\\omega = e^{-2 \\pi i / n}$ is the primitive root of $n$.\nThe matrix $DFT_{n}$ is a square matrix of size $n$ and the entries are given by:\n$DFT_{n}[k][l] = \\omega^{kl} = e^{-2 \\pi i \\frac{kl}{n}}$\nExample of DFT matrices At each index we will have the $ij$ th unit of root. For example if $n = 2$ we know that the root is $-1$, then the matrix would be: $$ DFT_{2} = \\begin{pmatrix}\n1 \u0026 1\\ 1 \u0026 -1\\ \\end{pmatrix} $$ This has two adds (one add and sub), it would be quite inefficient to write the multiplication part. This is usually called butterflies in signal processing, due to the nature of the circuit.\nfor $n = 4$, the primitive root is $i$ we have:\n$$ DFT_{4} = \\begin{pmatrix} 1 \u0026 1 \u0026 1 \u0026 1\\\\ 1 \u0026 i \u0026 -1 \u0026 -i\\\\ 1 \u0026 -1 \u0026 1 \u0026 -1\\\\ 1 \u0026 -i \u0026 -1 \u0026 i\\\\ \\end{pmatrix} $$If we assume complex everything, it has 12 additions and 4 multiplications. This matrix can be factorized, then we can add it as a series of matrix vector products.\nDecomposing into sparse MVM $$ \\begin{align*} t_{1} \u0026= T_{1}x\\\\ t_{2} \u0026= T_{2}t_{1}\\\\ \\vdots\\\\ t_{k} \u0026= T_{k}t_{k-1}\\\\ y \u0026= t_{k}\\\\ \\end{align*} $$ This makes sense if $T_{i}$ are sparse (see Sparse Matrix Vector Multiplication, and not too many $m$ steps).\nYou can use Group Theory to find this kind of transformations. $$ DFT_{4} = (DFT_{2} \\otimes I_{2}) \\cdot \\text{diag}(1,1,1,i) \\cdot (I_{2} \\otimes DFT_{2})L_{2}^{4} $$ You can see that it is also quite easy to implement it in hardware.\nIt can be similar for size $16$ and radix $4$.\n#### Other transforms IMDCT and DCT are useful transforms for MPEG and JPEG format, while DFT and its inverse can be considered universal transformation tools. FFT transformations General Radix Recursive Cooley-Tukey FFT This is the most general version of DFT, it has a similar structure compared to the previous ones.\n$$ \\begin{align*} DFT_{n} \u0026= (DFT_{n/r} \\otimes I_{r}) \\cdot \\text{diag}(1,1,…,\\omega^{0},\\omega^{1},…,\\omega^{r-1}) \\cdot (I_{n/r} \\otimes DFT_{r})L_{n/r}^{n}\\\n\\end{align*} $$ The diagonal matrix has the roots of unity. This is called the decimation in time frequency. It is possible also to use the decimation in frequency, which is just the transpose. We can decompose everything until we have size two butterfly operations (bunch of adds).\nCost of DFT Independently of recursion (the radix), we have a number of\n$n \\log_{2}(n)$ additions and $n \\log_{2}(n) / 2$ multiplications, but to be real we would need to consider real additions, so we have to multiply everything by two, to get the adds. For multiplication, we have four multiplication and two additions (image it as a matrix) (in reality you use the structure of roots of unity, so in reality you have less adds). Usually best is around radix 8 You will have about $\\leq3n \\log_{2}(n)$ real additions and $\\leq 2n \\log_{2}(n)$ complex multiplications, so upper bound of 5 operations. For a long time radix 2 iterative version was the best version, after superscalar processors like Skylake Microprocessor it has better versions. There is a practical lower bound analysis, but that is like Strassen Fast Linear Algebra, which is not much useful. Recursive vs iterative FFT The recursive version is good for re-use, has better locality. Triple loop is like the blocked MMM in Fast Linear Algebra. If we have big stages computed, we can continue with the next stage immediately.\nIterative similar, the op count is the same, is slower because of the (log n passes through the data). The code change is quite difficult. If we have much data, then at each iteration we need to load the whole data which could be expensive.\nDecimation in Time and Frequency TODO\nOther FFTs Pease FFT Highly parallelized with maps and shuffles.\nStockham FFT It is good for vector computers of the 80s, where we have long vectors Six-Step FFT Multi-core FFT Good for Sharing memory. Fastest Fourier Transform of the West Also known as FFTW, we say.\nIdeas for FFTW Merging Steps In the original version, the original permutation could be very expensive, to load everything. There is no need to keep it as a sperate step, we can fuse it in the next step. This fusion would need more data, because it needs to write to another place (no-inplace computation!). The scaling can also be fused, with the previous or next step (just change the kernel). Strides will change as we recurse for the DFTrec, and we can also interchange input and output to save space. Because of the power of two strides, often it is very difficult to reach peak performance.\nConstants We precompute the constants of the sins and cosines to save time (just need what roots of unity you need in order to compute it). They just depend on the input size, so they precompute it at the beginning of the function.\nBlock un-rolling We un-roll the basic blocks at the end to get longer codes, less recursion (size 32 is good basecase for example).\nProgram Generator We have DAG generator (for many types of FFT), a simplifier for the DAG (specific for the FFT computation).\nAn example of a simplification is when you have $x - y$ and $y - x$, an optimization would be flipping one after you have computed one. Also constants come in pairs (minus and positive version). Reduces register pressure. ",
  "wordCount" : "1026",
  "inLanguage": "en",
  "image": "https://flecart.github.io/images/papermod-cover.png","datePublished": "2025-04-07T00:00:00Z",
  "dateModified": "2025-04-07T00:00:00Z",
  "author":{
    "@type": "Person",
    "name": "Xuanqiang Angelo Huang"
  },
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://flecart.github.io/notes/fast-fourier-transforms/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "X. Angelo Huang's Blog",
    "logo": {
      "@type": "ImageObject",
      "url": "https://flecart.github.io/favicon-192x192.png"
    }
  }
}
</script>
</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://flecart.github.io/" accesskey="h" title="X. Angelo Huang&#39;s Blog (Alt + H)">X. Angelo Huang&#39;s Blog</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="https://flecart.github.io/notes/" title="Notes">
                    <span>Notes</span>
                </a>
            </li>
            <li>
                <a href="https://flecart.github.io/archives" title="Archive">
                    <span>Archive</span>
                </a>
            </li>
            <li>
                <a href="https://flecart.github.io/search/" title="Search (Alt &#43; /)" accesskey=/>
                    <span>Search</span>
                </a>
            </li>
            <li>
                <a href="https://flecart.github.io/tags/" title="Tags">
                    <span>Tags</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    <div class="breadcrumbs"><a href="https://flecart.github.io/">Home</a>&nbsp;»&nbsp;<a href="https://flecart.github.io/notes/">Notes</a></div>
    <h1 class="post-title entry-hint-parent">
      Fast Fourier Transforms
    </h1>
    <div class="post-meta"><span title='2025-04-07 00:00:00 +0000 UTC'>April 7, 2025</span>&nbsp;·&nbsp;Reading Time: 5 minutes&nbsp;·&nbsp;
By Xuanqiang Angelo Huang

</div>
  </header> <div class="toc">
    <details >
        <summary accesskey="c" title="(Alt + C)">
            <span class="details">Table of Contents</span>
        </summary>

        <div class="inner"><ul><ul><ul>
                <li>
                    <a href="#example-of-transforms" aria-label="Example of transforms">Example of transforms</a></li></ul>
                    
                <li>
                    <a href="#discrete-fourier-transforms" aria-label="Discrete Fourier Transforms">Discrete Fourier Transforms</a><ul>
                        
                <li>
                    <a href="#primitive-roots" aria-label="Primitive roots">Primitive roots</a></li>
                <li>
                    <a href="#example-of-dft-matrices" aria-label="Example of DFT matrices">Example of DFT matrices</a></li>
                <li>
                    <a href="#decomposing-into-sparse-mvm" aria-label="Decomposing into sparse MVM">Decomposing into sparse MVM</a></li></ul>
                </li></ul>
                    
                <li>
                    <a href="#fft-transformations" aria-label="FFT transformations">FFT transformations</a><ul>
                        
                <li>
                    <a href="#general-radix-recursive-cooley-tukey-fft" aria-label="General Radix Recursive Cooley-Tukey FFT">General Radix Recursive Cooley-Tukey FFT</a><ul>
                        
                <li>
                    <a href="#cost-of-dft" aria-label="Cost of DFT">Cost of DFT</a></li>
                <li>
                    <a href="#recursive-vs-iterative-fft" aria-label="Recursive vs iterative FFT">Recursive vs iterative FFT</a></li>
                <li>
                    <a href="#decimation-in-time-and-frequency" aria-label="Decimation in Time and Frequency">Decimation in Time and Frequency</a></li></ul>
                </li>
                <li>
                    <a href="#other-ffts" aria-label="Other FFTs">Other FFTs</a><ul>
                        
                <li>
                    <a href="#pease-fft" aria-label="Pease FFT">Pease FFT</a></li>
                <li>
                    <a href="#stockham-fft" aria-label="Stockham FFT">Stockham FFT</a></li>
                <li>
                    <a href="#six-step-fft" aria-label="Six-Step FFT">Six-Step FFT</a></li>
                <li>
                    <a href="#multi-core-fft" aria-label="Multi-core FFT">Multi-core FFT</a></li></ul>
                </li></ul>
                </li>
                <li>
                    <a href="#fastest-fourier-transform-of-the-west" aria-label="Fastest Fourier Transform of the West">Fastest Fourier Transform of the West</a><ul>
                        
                <li>
                    <a href="#ideas-for-fftw" aria-label="Ideas for FFTW">Ideas for FFTW</a><ul>
                        
                <li>
                    <a href="#merging-steps" aria-label="Merging Steps">Merging Steps</a></li>
                <li>
                    <a href="#constants" aria-label="Constants">Constants</a></li>
                <li>
                    <a href="#block-un-rolling" aria-label="Block un-rolling">Block un-rolling</a></li>
                <li>
                    <a href="#program-generator" aria-label="Program Generator">Program Generator</a>
                </li>
            </ul>
            </li>
            </ul>
            </li>
            </ul>
        </div>
    </details>
</div>

  <div class="post-content"><p>The algorithm has been the same, some ideas are in <a href="/notes/fourier-series">Fourier Series</a>, but architectures change, which means there are new ways to make this algorithm even faster.</p>
<h4 id="example-of-transforms">Example of transforms<a hidden class="anchor" aria-hidden="true" href="#example-of-transforms">#</a></h4>
<p>We have learned in <a href="/notes/algebra-lineare-numerica">Algebra lineare numerica</a>, <a href="/notes/cambio-di-base">Cambio di Base</a> that linear transforms are usually a <strong>change of basis</strong>. They are matrix vector multiplications (additions and multiplications by <em>constants</em>). The optimizations are based on what sorts of transforms we have (e.g. <a href="/notes/sparse-matrix-vector-multiplication">Sparse Matrix Vector Multiplication</a>, or dense versions).
The same idea applies also for Fourier transforms.</p>
<h3 id="discrete-fourier-transforms">Discrete Fourier Transforms<a hidden class="anchor" aria-hidden="true" href="#discrete-fourier-transforms">#</a></h3>
<h4 id="primitive-roots">Primitive roots<a hidden class="anchor" aria-hidden="true" href="#primitive-roots">#</a></h4>
<p>It uses <strong>primitive</strong> roots of $n$ as coefficients. Discrete Fourier transform computes:</p>
<p>$$
\begin{align*}</p>
<p>y_{k} &amp;= \sum_{l = 0} ^{n-1} x_{l} \cdot e^{-2 \pi i \frac{kl}{n}}\
&amp;= \sum_{l = 0} ^{n-1} x_{l} \cdot \omega^{kl}\
\end{align*}
$$</p>
<p>Where $\omega = e^{-2 \pi i / n}$ is the primitive root of $n$.</p>
<p>The matrix $DFT_{n}$ is a square matrix of size $n$ and the entries are given by:</p>
<p>$DFT_{n}[k][l] = \omega^{kl} = e^{-2 \pi i \frac{kl}{n}}$</p>
<h4 id="example-of-dft-matrices">Example of DFT matrices<a hidden class="anchor" aria-hidden="true" href="#example-of-dft-matrices">#</a></h4>
<p>At each index we will have the $ij$ th unit of root.
For example if $n = 2$ we know that the root is $-1$, then the matrix would be:
$$
DFT_{2} = \begin{pmatrix}</p>
<p>1 &amp; 1\
1 &amp; -1\
\end{pmatrix}
$$
This has two adds (one add and sub), it would be quite inefficient to write the multiplication part. This is usually called butterflies in signal processing, due to the nature of the circuit.</p>
<p>for $n = 4$, the primitive root is $i$ we have:</p>
$$
DFT_{4} = \begin{pmatrix}
1 & 1 & 1 & 1\\
1 & i & -1 & -i\\
1 & -1 & 1 & -1\\
1 & -i & -1 & i\\
\end{pmatrix}
$$<p>If we assume complex everything, it has 12 additions and 4 multiplications.
This matrix can be factorized, then we can add it as a series of matrix vector products.</p>
<h4 id="decomposing-into-sparse-mvm">Decomposing into sparse MVM<a hidden class="anchor" aria-hidden="true" href="#decomposing-into-sparse-mvm">#</a></h4>
$$
\begin{align*}
t_{1} &= T_{1}x\\
t_{2} &= T_{2}t_{1}\\
\vdots\\
t_{k} &= T_{k}t_{k-1}\\
y &= t_{k}\\
\end{align*}
$$<p>
This makes sense if $T_{i}$ are sparse (see <a href="/notes/sparse-matrix-vector-multiplication">Sparse Matrix Vector Multiplication</a>, and not too many $m$ steps).</p>
<img src="/images/notes/Fast Fourier Transforms-20250407104034779.webp" style="width: 100%" class="center" alt="Fast Fourier Transforms-20250407104034779">
You can use <a href="/notes/gruppi">Group Theory</a> to find this kind of transformations.
$$
DFT_{4} = (DFT_{2}  \otimes I_{2}) \cdot \text{diag}(1,1,1,i) \cdot (I_{2} \otimes DFT_{2})L_{2}^{4}
$$<p>
You can see that it is also quite easy  to implement it in hardware.</p>
<p>It can be similar for size $16$ and radix $4$.</p>
<img src="/images/notes/Fast Fourier Transforms-20250407104645928.webp" style="width: 100%" class="center" alt="Fast Fourier Transforms-20250407104645928">
#### Other transforms
IMDCT and DCT are useful transforms for MPEG and JPEG format, while DFT and its inverse can be considered universal transformation tools.
<h2 id="fft-transformations">FFT transformations<a hidden class="anchor" aria-hidden="true" href="#fft-transformations">#</a></h2>
<h3 id="general-radix-recursive-cooley-tukey-fft">General Radix Recursive Cooley-Tukey FFT<a hidden class="anchor" aria-hidden="true" href="#general-radix-recursive-cooley-tukey-fft">#</a></h3>
<p>This is the most general version of DFT, it has a similar structure compared to the previous ones.</p>
<p>$$
\begin{align*}
DFT_{n} &amp;= (DFT_{n/r} \otimes I_{r}) \cdot \text{diag}(1,1,&hellip;,\omega^{0},\omega^{1},&hellip;,\omega^{r-1}) \cdot (I_{n/r} \otimes DFT_{r})L_{n/r}^{n}\</p>
<p>\end{align*}
$$
The diagonal matrix has the roots of unity. This is called the <strong>decimation in time</strong> frequency.
It is possible also to use the decimation in frequency, which is just the transpose.
We can decompose everything until we have size two butterfly operations (bunch of adds).</p>
<h4 id="cost-of-dft">Cost of DFT<a hidden class="anchor" aria-hidden="true" href="#cost-of-dft">#</a></h4>
<p>Independently of recursion (the radix), we have a number of</p>
<ul>
<li>$n \log_{2}(n)$ additions and $n \log_{2}(n) / 2$ multiplications, but to be real we would need to consider real additions, so we have to multiply everything by two, to get the adds. For multiplication, we have four multiplication and two additions (image it as a matrix) (in reality you use the structure of roots of unity, so in reality you have less adds). Usually best is around radix 8</li>
<li>You will have about $\leq3n \log_{2}(n)$ real additions and $\leq 2n \log_{2}(n)$ complex multiplications, so upper bound of 5 operations.
For a long time radix 2 iterative version was the best version, after superscalar processors like <a href="/notes/skylake-microprocessor">Skylake Microprocessor</a> it has better versions.
<img src="/images/notes/Fast Fourier Transforms-20250407113518669.webp" style="width: 100%" class="center" alt="Fast Fourier Transforms-20250407113518669">
There is a practical lower bound analysis, but that is like Strassen <a href="/notes/fast-linear-algebra">Fast Linear Algebra</a>, which is not much useful.</li>
</ul>
<h4 id="recursive-vs-iterative-fft">Recursive vs iterative FFT<a hidden class="anchor" aria-hidden="true" href="#recursive-vs-iterative-fft">#</a></h4>
<p>The recursive version is good for <strong>re-use</strong>, has better locality. Triple loop is like the blocked MMM in <a href="/notes/fast-linear-algebra">Fast Linear Algebra</a>. If we have big stages computed, we can continue with the next stage immediately.</p>
<p>Iterative similar, the op count is the same, is slower because of the (log n passes through the data).
The code change is quite difficult. If we have much data, then at each iteration we need to load the whole data which could be expensive.</p>
<h4 id="decimation-in-time-and-frequency">Decimation in Time and Frequency<a hidden class="anchor" aria-hidden="true" href="#decimation-in-time-and-frequency">#</a></h4>
<p>TODO</p>
<h3 id="other-ffts">Other FFTs<a hidden class="anchor" aria-hidden="true" href="#other-ffts">#</a></h3>
<h4 id="pease-fft">Pease FFT<a hidden class="anchor" aria-hidden="true" href="#pease-fft">#</a></h4>
<p>Highly parallelized with maps and shuffles.</p>
<img src="/images/notes/Fast Fourier Transforms-20250407113023076.webp" style="width: 100%" class="center" alt="Fast Fourier Transforms-20250407113023076">
<h4 id="stockham-fft">Stockham FFT<a hidden class="anchor" aria-hidden="true" href="#stockham-fft">#</a></h4>
<p>It is good for vector computers of the 80s, where we have long vectors
<img src="/images/notes/Fast Fourier Transforms-20250407113041765.webp" style="width: 100%" class="center" alt="Fast Fourier Transforms-20250407113041765"></p>
<h4 id="six-step-fft">Six-Step FFT<a hidden class="anchor" aria-hidden="true" href="#six-step-fft">#</a></h4>
<img src="/images/notes/Fast Fourier Transforms-20250407113054802.webp" style="width: 100%" class="center" alt="Fast Fourier Transforms-20250407113054802">
<h4 id="multi-core-fft">Multi-core FFT<a hidden class="anchor" aria-hidden="true" href="#multi-core-fft">#</a></h4>
<p>Good for Sharing memory.
<img src="/images/notes/Fast Fourier Transforms-20250407113116841.webp" style="width: 100%" class="center" alt="Fast Fourier Transforms-20250407113116841"></p>
<h2 id="fastest-fourier-transform-of-the-west">Fastest Fourier Transform of the West<a hidden class="anchor" aria-hidden="true" href="#fastest-fourier-transform-of-the-west">#</a></h2>
<p>Also known as FFTW, we say.</p>
<h3 id="ideas-for-fftw">Ideas for FFTW<a hidden class="anchor" aria-hidden="true" href="#ideas-for-fftw">#</a></h3>
<h4 id="merging-steps">Merging Steps<a hidden class="anchor" aria-hidden="true" href="#merging-steps">#</a></h4>
<ol>
<li>In the original version, the original permutation could be very expensive, to load everything. There is no need to keep it as a sperate step, we can fuse it in the next step.
<ol>
<li>This fusion would need more data, because it needs to write to another place (<em>no-inplace</em> computation!).</li>
</ol>
</li>
<li>The scaling can also be fused, with the previous or next step (just change the kernel).
<img src="/images/notes/Fast Fourier Transforms-20250414103632830.webp" style="width: 100%" class="center" alt="Fast Fourier Transforms-20250414103632830"></li>
</ol>
<p>Strides will change as we recurse for the <code>DFTrec</code>, and we can also interchange input and output to save space. Because of the power of two strides, often it is very difficult to reach peak  performance.</p>
<h4 id="constants">Constants<a hidden class="anchor" aria-hidden="true" href="#constants">#</a></h4>
<p>We precompute the constants of the sins and cosines to save time (just need what roots of unity you need in order to compute it).
They just depend on the input size, so they precompute it at the beginning of the function.</p>
<h4 id="block-un-rolling">Block un-rolling<a hidden class="anchor" aria-hidden="true" href="#block-un-rolling">#</a></h4>
<p>We un-roll the basic blocks at the end to get longer codes, less recursion (size 32 is good basecase for example).</p>
<h4 id="program-generator">Program Generator<a hidden class="anchor" aria-hidden="true" href="#program-generator">#</a></h4>
<p>We have DAG generator (for many types of FFT), a simplifier for the DAG (specific for the FFT computation).</p>
<ul>
<li>An example of a simplification is when you have $x - y$ and $y - x$, an optimization would be flipping one after you have computed one.</li>
<li>Also constants come in pairs (minus and positive version).
<ul>
<li>Reduces register pressure.</li>
</ul>
</li>
</ul>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="https://flecart.github.io/tags/advanced-systems-lab/">Advanced-Systems-Lab</a></li>
    </ul>


<ul class="share-buttons">
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share Fast Fourier Transforms on x"
            href="https://x.com/intent/tweet/?text=Fast%20Fourier%20Transforms&amp;url=https%3a%2f%2fflecart.github.io%2fnotes%2ffast-fourier-transforms%2f&amp;hashtags=advanced-systems-lab">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M512 62.554 L 512 449.446 C 512 483.97 483.97 512 449.446 512 L 62.554 512 C 28.03 512 0 483.97 0 449.446 L 0 62.554 C 0 28.03 28.029 0 62.554 0 L 449.446 0 C 483.971 0 512 28.03 512 62.554 Z M 269.951 190.75 L 182.567 75.216 L 56 75.216 L 207.216 272.95 L 63.9 436.783 L 125.266 436.783 L 235.9 310.383 L 332.567 436.783 L 456 436.783 L 298.367 228.367 L 432.367 75.216 L 371.033 75.216 Z M 127.633 110 L 164.101 110 L 383.481 400.065 L 349.5 400.065 Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share Fast Fourier Transforms on linkedin"
            href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2fflecart.github.io%2fnotes%2ffast-fourier-transforms%2f&amp;title=Fast%20Fourier%20Transforms&amp;summary=Fast%20Fourier%20Transforms&amp;source=https%3a%2f%2fflecart.github.io%2fnotes%2ffast-fourier-transforms%2f">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-288.985,423.278l0,-225.717l-75.04,0l0,225.717l75.04,0Zm270.539,0l0,-129.439c0,-69.333 -37.018,-101.586 -86.381,-101.586c-39.804,0 -57.634,21.891 -67.617,37.266l0,-31.958l-75.021,0c0.995,21.181 0,225.717 0,225.717l75.02,0l0,-126.056c0,-6.748 0.486,-13.492 2.474,-18.315c5.414,-13.475 17.767,-27.434 38.494,-27.434c27.135,0 38.007,20.707 38.007,51.037l0,120.768l75.024,0Zm-307.552,-334.556c-25.674,0 -42.448,16.879 -42.448,39.002c0,21.658 16.264,39.002 41.455,39.002l0.484,0c26.165,0 42.452,-17.344 42.452,-39.002c-0.485,-22.092 -16.241,-38.954 -41.943,-39.002Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share Fast Fourier Transforms on reddit"
            href="https://reddit.com/submit?url=https%3a%2f%2fflecart.github.io%2fnotes%2ffast-fourier-transforms%2f&title=Fast%20Fourier%20Transforms">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-3.446,265.638c0,-22.964 -18.616,-41.58 -41.58,-41.58c-11.211,0 -21.361,4.457 -28.841,11.666c-28.424,-20.508 -67.586,-33.757 -111.204,-35.278l18.941,-89.121l61.884,13.157c0.756,15.734 13.642,28.29 29.56,28.29c16.407,0 29.706,-13.299 29.706,-29.701c0,-16.403 -13.299,-29.702 -29.706,-29.702c-11.666,0 -21.657,6.792 -26.515,16.578l-69.105,-14.69c-1.922,-0.418 -3.939,-0.042 -5.585,1.036c-1.658,1.073 -2.811,2.761 -3.224,4.686l-21.152,99.438c-44.258,1.228 -84.046,14.494 -112.837,35.232c-7.468,-7.164 -17.589,-11.591 -28.757,-11.591c-22.965,0 -41.585,18.616 -41.585,41.58c0,16.896 10.095,31.41 24.568,37.918c-0.639,4.135 -0.99,8.328 -0.99,12.576c0,63.977 74.469,115.836 166.33,115.836c91.861,0 166.334,-51.859 166.334,-115.836c0,-4.218 -0.347,-8.387 -0.977,-12.493c14.564,-6.47 24.735,-21.034 24.735,-38.001Zm-119.474,108.193c-20.27,20.241 -59.115,21.816 -70.534,21.816c-11.428,0 -50.277,-1.575 -70.522,-21.82c-3.007,-3.008 -3.007,-7.882 0,-10.889c3.003,-2.999 7.882,-3.003 10.885,0c12.777,12.781 40.11,17.317 59.637,17.317c19.522,0 46.86,-4.536 59.657,-17.321c3.016,-2.999 7.886,-2.995 10.885,0.008c3.008,3.011 3.003,7.882 -0.008,10.889Zm-5.23,-48.781c-16.373,0 -29.701,-13.324 -29.701,-29.698c0,-16.381 13.328,-29.714 29.701,-29.714c16.378,0 29.706,13.333 29.706,29.714c0,16.374 -13.328,29.698 -29.706,29.698Zm-160.386,-29.702c0,-16.381 13.328,-29.71 29.714,-29.71c16.369,0 29.689,13.329 29.689,29.71c0,16.373 -13.32,29.693 -29.689,29.693c-16.386,0 -29.714,-13.32 -29.714,-29.693Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share Fast Fourier Transforms on facebook"
            href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fflecart.github.io%2fnotes%2ffast-fourier-transforms%2f">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-106.468,0l0,-192.915l66.6,0l12.672,-82.621l-79.272,0l0,-53.617c0,-22.603 11.073,-44.636 46.58,-44.636l36.042,0l0,-70.34c0,0 -32.71,-5.582 -63.982,-5.582c-65.288,0 -107.96,39.569 -107.96,111.204l0,62.971l-72.573,0l0,82.621l72.573,0l0,192.915l-191.104,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share Fast Fourier Transforms on whatsapp"
            href="https://api.whatsapp.com/send?text=Fast%20Fourier%20Transforms%20-%20https%3a%2f%2fflecart.github.io%2fnotes%2ffast-fourier-transforms%2f">
            <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve" height="30px" width="30px" fill="currentColor">
                <path
                    d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-58.673,127.703c-33.842,-33.881 -78.847,-52.548 -126.798,-52.568c-98.799,0 -179.21,80.405 -179.249,179.234c-0.013,31.593 8.241,62.428 23.927,89.612l-25.429,92.884l95.021,-24.925c26.181,14.28 55.659,21.807 85.658,21.816l0.074,0c98.789,0 179.206,-80.413 179.247,-179.243c0.018,-47.895 -18.61,-92.93 -52.451,-126.81Zm-126.797,275.782l-0.06,0c-26.734,-0.01 -52.954,-7.193 -75.828,-20.767l-5.441,-3.229l-56.386,14.792l15.05,-54.977l-3.542,-5.637c-14.913,-23.72 -22.791,-51.136 -22.779,-79.287c0.033,-82.142 66.867,-148.971 149.046,-148.971c39.793,0.014 77.199,15.531 105.329,43.692c28.128,28.16 43.609,65.592 43.594,105.4c-0.034,82.149 -66.866,148.983 -148.983,148.984Zm81.721,-111.581c-4.479,-2.242 -26.499,-13.075 -30.604,-14.571c-4.105,-1.495 -7.091,-2.241 -10.077,2.241c-2.986,4.483 -11.569,14.572 -14.182,17.562c-2.612,2.988 -5.225,3.364 -9.703,1.12c-4.479,-2.241 -18.91,-6.97 -36.017,-22.23c-13.314,-11.876 -22.304,-26.542 -24.916,-31.026c-2.612,-4.484 -0.279,-6.908 1.963,-9.14c2.016,-2.007 4.48,-5.232 6.719,-7.847c2.24,-2.615 2.986,-4.484 4.479,-7.472c1.493,-2.99 0.747,-5.604 -0.374,-7.846c-1.119,-2.241 -10.077,-24.288 -13.809,-33.256c-3.635,-8.733 -7.327,-7.55 -10.077,-7.688c-2.609,-0.13 -5.598,-0.158 -8.583,-0.158c-2.986,0 -7.839,1.121 -11.944,5.604c-4.105,4.484 -15.675,15.32 -15.675,37.364c0,22.046 16.048,43.342 18.287,46.332c2.24,2.99 31.582,48.227 76.511,67.627c10.685,4.615 19.028,7.371 25.533,9.434c10.728,3.41 20.492,2.929 28.209,1.775c8.605,-1.285 26.499,-10.833 30.231,-21.295c3.732,-10.464 3.732,-19.431 2.612,-21.298c-1.119,-1.869 -4.105,-2.99 -8.583,-5.232Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share Fast Fourier Transforms on telegram"
            href="https://telegram.me/share/url?text=Fast%20Fourier%20Transforms&amp;url=https%3a%2f%2fflecart.github.io%2fnotes%2ffast-fourier-transforms%2f">
            <svg version="1.1" xml:space="preserve" viewBox="2 2 28 28" height="30px" width="30px" fill="currentColor">
                <path
                    d="M26.49,29.86H5.5a3.37,3.37,0,0,1-2.47-1,3.35,3.35,0,0,1-1-2.47V5.48A3.36,3.36,0,0,1,3,3,3.37,3.37,0,0,1,5.5,2h21A3.38,3.38,0,0,1,29,3a3.36,3.36,0,0,1,1,2.46V26.37a3.35,3.35,0,0,1-1,2.47A3.38,3.38,0,0,1,26.49,29.86Zm-5.38-6.71a.79.79,0,0,0,.85-.66L24.73,9.24a.55.55,0,0,0-.18-.46.62.62,0,0,0-.41-.17q-.08,0-16.53,6.11a.59.59,0,0,0-.41.59.57.57,0,0,0,.43.52l4,1.24,1.61,4.83a.62.62,0,0,0,.63.43.56.56,0,0,0,.4-.17L16.54,20l4.09,3A.9.9,0,0,0,21.11,23.15ZM13.8,20.71l-1.21-4q8.72-5.55,8.78-5.55c.15,0,.23,0,.23.16a.18.18,0,0,1,0,.06s-2.51,2.3-7.52,6.8Z" />
            </svg>
        </a>
    </li>
    <li>
        <a target="_blank" rel="noopener noreferrer" aria-label="share Fast Fourier Transforms on ycombinator"
            href="https://news.ycombinator.com/submitlink?t=Fast%20Fourier%20Transforms&u=https%3a%2f%2fflecart.github.io%2fnotes%2ffast-fourier-transforms%2f">
            <svg version="1.1" xml:space="preserve" width="30px" height="30px" viewBox="0 0 512 512" fill="currentColor"
                xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape">
                <path
                    d="M449.446 0C483.971 0 512 28.03 512 62.554L512 449.446C512 483.97 483.97 512 449.446 512L62.554 512C28.03 512 0 483.97 0 449.446L0 62.554C0 28.03 28.029 0 62.554 0L449.446 0ZM183.8767 87.9921H121.8427L230.6673 292.4508V424.0079H281.3328V292.4508L390.1575 87.9921H328.1233L256 238.2489z" />
            </svg>
        </a>
    </li>
</ul>

  </footer>
</article>
    </main>
    
<footer class="footer">
        <span>&copy; 2025 <a href="https://flecart.github.io/">X. Angelo Huang&#39;s Blog</a></span> · 

    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;

        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerHTML = 'copy';

        function copyingDone() {
            copybutton.innerHTML = 'copied!';
            setTimeout(() => {
                copybutton.innerHTML = 'copy';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                navigator.clipboard.writeText(codeblock.textContent);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) { };
            selection.removeRange(range);
        });

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
        } else if (container.parentNode.firstChild == container) {
            
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
        } else {
            
            codeblock.parentNode.appendChild(copybutton);
        }
    });
</script>
</body>

</html>
